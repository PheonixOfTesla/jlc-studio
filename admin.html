<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>JLC Studio - Admin Dashboard</title>
    <link href="https://fonts.googleapis.com/css2?family=Cormorant+Garamond:wght@500;600&family=Montserrat:wght@400;500;600&display=swap" rel="stylesheet">
    <style>
        * { margin: 0; padding: 0; box-sizing: border-box; }
        :root {
            --gold: #C4A052;
            --gold-dark: #A68A42;
            --dark: #1a1a1a;
            --gray: #666;
            --light-gray: #999;
            --bg: #f8f8f8;
            --white: #fff;
            --green: #2ecc71;
            --blue: #3498db;
            --orange: #e67e22;
        }
        body { font-family: 'Montserrat', sans-serif; background: var(--bg); min-height: 100vh; }

        /* Login Screen */
        .login-screen {
            min-height: 100vh;
            display: flex;
            align-items: center;
            justify-content: center;
            background: linear-gradient(135deg, var(--dark) 0%, #2d2d2d 100%);
        }
        .login-box {
            background: var(--white);
            padding: 3rem;
            border-radius: 16px;
            width: 100%;
            max-width: 400px;
            box-shadow: 0 20px 60px rgba(0,0,0,0.3);
        }
        .login-logo {
            font-family: 'Cormorant Garamond', serif;
            font-size: 2rem;
            color: var(--gold);
            text-align: center;
            margin-bottom: 2rem;
        }
        .form-group { margin-bottom: 1.5rem; }
        .form-group label { display: block; font-size: 0.85rem; font-weight: 500; margin-bottom: 0.5rem; }
        .form-group input, .form-group textarea, .form-group select {
            width: 100%;
            padding: 0.875rem 1rem;
            border: 2px solid #e0e0e0;
            border-radius: 8px;
            font-size: 1rem;
            font-family: inherit;
            transition: border-color 0.3s;
        }
        .form-group input:focus, .form-group textarea:focus { outline: none; border-color: var(--gold); }
        .btn {
            display: inline-flex;
            align-items: center;
            justify-content: center;
            gap: 0.5rem;
            padding: 0.875rem 1.5rem;
            border: none;
            border-radius: 8px;
            font-size: 0.9rem;
            font-weight: 600;
            cursor: pointer;
            transition: all 0.3s;
        }
        .btn-primary { background: var(--gold); color: var(--white); width: 100%; }
        .btn-primary:hover { background: var(--gold-dark); }
        .btn-secondary { background: var(--bg); color: var(--dark); }
        .btn-small { padding: 0.5rem 1rem; font-size: 0.8rem; }
        .error-msg { background: #fee; color: #c00; padding: 1rem; border-radius: 8px; margin-bottom: 1rem; display: none; }
        .error-msg.show { display: block; }

        /* Dashboard */
        .dashboard { display: none; }
        .dashboard.active { display: block; }
        .login-screen.hidden { display: none; }

        /* Header */
        .header {
            background: var(--white);
            padding: 1rem 2rem;
            display: flex;
            justify-content: space-between;
            align-items: center;
            box-shadow: 0 2px 10px rgba(0,0,0,0.05);
            position: sticky;
            top: 0;
            z-index: 100;
        }
        .header-logo {
            font-family: 'Cormorant Garamond', serif;
            font-size: 1.5rem;
            color: var(--gold);
        }
        .header-user { display: flex; align-items: center; gap: 1rem; }
        .header-user span { color: var(--gray); font-size: 0.9rem; }
        .logout-btn {
            background: none;
            border: 1px solid #ddd;
            padding: 0.5rem 1rem;
            border-radius: 6px;
            cursor: pointer;
            font-size: 0.85rem;
            color: var(--gray);
        }
        .logout-btn:hover { border-color: var(--gold); color: var(--gold); }

        /* Main Layout */
        .main { display: flex; min-height: calc(100vh - 60px); }
        .sidebar {
            width: 240px;
            background: var(--white);
            border-right: 1px solid #eee;
            padding: 1.5rem 0;
        }
        .nav-item {
            display: block;
            padding: 0.875rem 1.5rem;
            color: var(--gray);
            text-decoration: none;
            font-size: 0.9rem;
            border-left: 3px solid transparent;
            cursor: pointer;
            transition: all 0.2s;
        }
        .nav-item:hover, .nav-item.active {
            background: var(--bg);
            color: var(--dark);
            border-left-color: var(--gold);
        }
        .nav-item.active { font-weight: 600; }
        .content { flex: 1; padding: 2rem; overflow-y: auto; }

        /* Stats Cards */
        .stats-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(200px, 1fr));
            gap: 1.5rem;
            margin-bottom: 2rem;
        }
        .stat-card {
            background: var(--white);
            padding: 1.5rem;
            border-radius: 12px;
            box-shadow: 0 2px 8px rgba(0,0,0,0.04);
        }
        .stat-card h3 { font-size: 0.8rem; color: var(--gray); text-transform: uppercase; letter-spacing: 0.05em; margin-bottom: 0.5rem; }
        .stat-card .value { font-size: 2rem; font-weight: 600; color: var(--dark); }
        .stat-card .change { font-size: 0.85rem; color: var(--green); margin-top: 0.25rem; }
        .stat-card.green .value { color: var(--green); }
        .stat-card.blue .value { color: var(--blue); }
        .stat-card.orange .value { color: var(--orange); }

        /* Cards */
        .card {
            background: var(--white);
            border-radius: 12px;
            padding: 1.5rem;
            margin-bottom: 1.5rem;
            box-shadow: 0 2px 8px rgba(0,0,0,0.04);
        }
        .card-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 1.5rem;
            padding-bottom: 1rem;
            border-bottom: 1px solid #eee;
        }
        .card-header h2 { font-size: 1.1rem; font-weight: 600; }

        /* Sections */
        .section { display: none; }
        .section.active { display: block; }

        /* Page Header */
        .page-header { margin-bottom: 2rem; }
        .page-header h1 { font-family: 'Cormorant Garamond', serif; font-size: 1.75rem; margin-bottom: 0.25rem; }
        .page-header p { color: var(--gray); font-size: 0.9rem; }

        /* Form Layout */
        .form-row { display: grid; grid-template-columns: 1fr 1fr; gap: 1rem; }
        .form-hint { font-size: 0.8rem; color: var(--light-gray); margin-top: 0.25rem; }

        /* Image Upload */
        .image-upload {
            border: 2px dashed #ddd;
            border-radius: 8px;
            padding: 2rem;
            text-align: center;
            cursor: pointer;
            transition: all 0.3s;
            background: var(--bg);
        }
        .image-upload:hover { border-color: var(--gold); }
        .image-upload img { max-width: 150px; max-height: 150px; border-radius: 8px; margin-bottom: 0.5rem; }
        .image-upload input[type="file"] { display: none; }
        .image-upload p { color: var(--gray); font-size: 0.9rem; }

        /* List Items */
        .list-item {
            padding: 1rem;
            background: var(--bg);
            border-radius: 8px;
            margin-bottom: 0.75rem;
        }
        .list-item-header { display: flex; justify-content: space-between; align-items: center; margin-bottom: 0.75rem; }
        .list-item-title { font-weight: 600; }
        .delete-btn { background: none; border: none; color: #c00; cursor: pointer; font-size: 0.85rem; }

        /* Status Messages */
        .toast {
            position: fixed;
            bottom: 2rem;
            right: 2rem;
            padding: 1rem 1.5rem;
            background: var(--dark);
            color: var(--white);
            border-radius: 8px;
            box-shadow: 0 4px 20px rgba(0,0,0,0.2);
            transform: translateY(100px);
            opacity: 0;
            transition: all 0.3s;
        }
        .toast.show { transform: translateY(0); opacity: 1; }
        .toast.success { background: var(--green); }
        .toast.error { background: #c00; }
        .toast.info { background: var(--blue); }

        /* Bookings Table */
        .bookings-table { width: 100%; border-collapse: collapse; }
        .bookings-table th, .bookings-table td { padding: 1rem; text-align: left; border-bottom: 1px solid #eee; }
        .bookings-table th { font-size: 0.8rem; text-transform: uppercase; color: var(--gray); font-weight: 600; }
        .status-badge {
            display: inline-block;
            padding: 0.25rem 0.75rem;
            border-radius: 50px;
            font-size: 0.75rem;
            font-weight: 600;
        }
        .status-badge.confirmed { background: #e8f5e9; color: #2e7d32; }
        .status-badge.pending { background: #fff3e0; color: #ef6c00; }

        @media (max-width: 768px) {
            .sidebar { display: none; }
            .form-row { grid-template-columns: 1fr; }
            .stats-grid { grid-template-columns: 1fr 1fr; }
        }
    </style>
</head>
<body>
    <!-- LOGIN SCREEN -->
    <div class="login-screen" id="loginScreen">
        <div class="login-box">
            <div class="login-logo">JLC Studio</div>
            <div class="error-msg" id="loginError"></div>
            <form id="loginForm">
                <div class="form-group">
                    <label>Username</label>
                    <input type="text" id="username" required>
                </div>
                <div class="form-group">
                    <label>Password</label>
                    <input type="password" id="password" required>
                </div>
                <button type="submit" class="btn btn-primary">Sign In</button>
            </form>
        </div>
    </div>

    <!-- DASHBOARD -->
    <div class="dashboard" id="dashboard">
        <header class="header">
            <div class="header-logo">JLC Studio Admin</div>
            <div class="header-user">
                <span id="welcomeUser">Welcome, Admin</span>
                <button class="logout-btn" onclick="logout()">Logout</button>
            </div>
        </header>

        <div class="main">
            <aside class="sidebar">
                <nav>
                    <a class="nav-item active" data-section="overview">Overview</a>
                    <a class="nav-item" data-section="bookings">Bookings</a>
                    <a class="nav-item" data-section="content">Site Content</a>
                    <a class="nav-item" data-section="services">Services & Pricing</a>
                    <a class="nav-item" data-section="gallery">Gallery</a>
                    <a class="nav-item" data-section="settings">Settings</a>
                </nav>
            </aside>

            <main class="content">
                <!-- OVERVIEW -->
                <section id="overview" class="section active">
                    <div class="page-header">
                        <h1>Dashboard Overview</h1>
                        <p>Welcome back! Here's what's happening with your business.</p>
                    </div>

                    <div class="stats-grid">
                        <div class="stat-card">
                            <h3>This Month</h3>
                            <div class="value" id="monthlyBookings">0</div>
                            <div class="change">Bookings</div>
                        </div>
                        <div class="stat-card green">
                            <h3>Revenue</h3>
                            <div class="value" id="monthlyRevenue">$0</div>
                            <div class="change">This month</div>
                        </div>
                        <div class="stat-card blue">
                            <h3>Upcoming</h3>
                            <div class="value" id="upcomingEvents">0</div>
                            <div class="change">Events scheduled</div>
                        </div>
                        <div class="stat-card orange">
                            <h3>Inquiries</h3>
                            <div class="value" id="newInquiries">0</div>
                            <div class="change">New this week</div>
                        </div>
                    </div>

                    <div class="card">
                        <div class="card-header">
                            <h2>Upcoming Bookings</h2>
                            <button class="btn btn-secondary btn-small" onclick="showSection('bookings')">View All</button>
                        </div>
                        <table class="bookings-table">
                            <thead>
                                <tr>
                                    <th>Client</th>
                                    <th>Service</th>
                                    <th>Date</th>
                                    <th>Status</th>
                                </tr>
                            </thead>
                            <tbody id="recentBookings">
                                <tr>
                                    <td colspan="4" style="color: var(--gray); text-align: center;">Connect Calendly to see bookings</td>
                                </tr>
                            </tbody>
                        </table>
                    </div>
                </section>

                <!-- BOOKINGS -->
                <section id="bookings" class="section">
                    <div class="page-header">
                        <h1>Bookings</h1>
                        <p>Manage your consultations and event bookings</p>
                    </div>
                    <div class="card">
                        <p style="color: var(--gray); text-align: center; padding: 2rem;">
                            Bookings will sync from your Calendly account.<br>
                            <a href="https://calendly.com/jlcstudiollc" target="_blank" style="color: var(--gold);">Open Calendly Dashboard →</a>
                        </p>
                    </div>
                </section>

                <!-- SITE CONTENT -->
                <section id="content" class="section">
                    <div class="page-header">
                        <h1>Site Content</h1>
                        <p>Edit your website text and images</p>
                    </div>

                    <div class="card">
                        <div class="card-header"><h2>Hero Section</h2></div>
                        <form id="heroForm">
                            <div class="form-group">
                                <label>Badge Text</label>
                                <input type="text" id="heroBadge" value="Sarasota's Premier Creative Studio">
                            </div>
                            <div class="form-row">
                                <div class="form-group">
                                    <label>Title Line 1</label>
                                    <input type="text" id="heroTitle1" value="Where Creativity">
                                </div>
                                <div class="form-group">
                                    <label>Title Line 2</label>
                                    <input type="text" id="heroTitle2" value="Meets Occasion">
                                </div>
                            </div>
                            <div class="form-group">
                                <label>Tagline</label>
                                <input type="text" id="heroTagline" value="Florals • Event Decor • Custom Tailoring">
                            </div>
                            <div class="form-group">
                                <label>Description</label>
                                <textarea id="heroDesc" rows="2">Every detail designed with intention for life's most important moments.</textarea>
                            </div>
                            <button type="submit" class="btn btn-primary" style="width: auto;">Save Hero</button>
                        </form>
                    </div>

                    <div class="card">
                        <div class="card-header"><h2>About Section</h2></div>
                        <form id="aboutForm">
                            <div class="form-row">
                                <div class="form-group">
                                    <label>Your Name</label>
                                    <input type="text" id="aboutName" value="JLynne Huffer">
                                </div>
                                <div class="form-group">
                                    <label>Title</label>
                                    <input type="text" id="aboutTitle" value="Founder & Creative Director">
                                </div>
                            </div>
                            <div class="form-group">
                                <label>Profile Photo</label>
                                <div class="image-upload" onclick="document.getElementById('photoInput').click()">
                                    <img id="photoPreview" src="" style="display:none">
                                    <p>Click to upload your photo</p>
                                    <input type="file" id="photoInput" accept="image/*" onchange="previewImage(this, 'photoPreview')">
                                </div>
                            </div>
                            <div class="form-group">
                                <label>Short Bio</label>
                                <textarea id="aboutBio" rows="4">A multidisciplinary creative professional with over 15 years of experience spanning fashion design, event decor, and floral artistry.</textarea>
                            </div>
                            <div class="form-row">
                                <div class="form-group">
                                    <label>Years Experience</label>
                                    <input type="number" id="aboutYears" value="15">
                                </div>
                                <div class="form-group">
                                    <label>Events Created</label>
                                    <input type="number" id="aboutEvents" value="500">
                                </div>
                            </div>
                            <button type="submit" class="btn btn-primary" style="width: auto;">Save About</button>
                        </form>
                    </div>
                </section>

                <!-- SERVICES & PRICING -->
                <section id="services" class="section">
                    <div class="page-header">
                        <h1>Services & Pricing</h1>
                        <p>Update your service offerings and prices</p>
                    </div>

                    <div class="card">
                        <div class="card-header"><h2>Floral Design</h2></div>
                        <div id="floralPricing"></div>
                        <button class="btn btn-secondary btn-small" onclick="addPricing('floral')">+ Add Pricing</button>
                    </div>

                    <div class="card">
                        <div class="card-header"><h2>Event Decor</h2></div>
                        <div id="decorPricing"></div>
                        <button class="btn btn-secondary btn-small" onclick="addPricing('decor')">+ Add Pricing</button>
                    </div>

                    <div class="card">
                        <div class="card-header"><h2>Custom Tailoring</h2></div>
                        <div id="tailoringPricing"></div>
                        <button class="btn btn-secondary btn-small" onclick="addPricing('tailoring')">+ Add Pricing</button>
                    </div>
                </section>

                <!-- GALLERY -->
                <section id="gallery" class="section">
                    <div class="page-header">
                        <h1>Gallery</h1>
                        <p>Manage your portfolio images</p>
                    </div>
                    <div class="card">
                        <div class="card-header">
                            <h2>Portfolio Images</h2>
                            <button class="btn btn-secondary btn-small">+ Add Image</button>
                        </div>
                        <p style="color: var(--gray); padding: 2rem; text-align: center;">
                            Drop images here or click to upload
                        </p>
                    </div>
                </section>

                <!-- SETTINGS -->
                <section id="settings" class="section">
                    <div class="page-header">
                        <h1>Settings</h1>
                        <p>Business information and integrations</p>
                    </div>

                    <div class="card">
                        <div class="card-header"><h2>Contact Information</h2></div>
                        <form id="settingsForm">
                            <div class="form-row">
                                <div class="form-group">
                                    <label>Phone</label>
                                    <input type="tel" id="settingsPhone" value="(941) 769-7526">
                                </div>
                                <div class="form-group">
                                    <label>Email</label>
                                    <input type="email" id="settingsEmail" value="jeremyhuffer@gmail.com">
                                </div>
                            </div>
                            <div class="form-group">
                                <label>Address</label>
                                <input type="text" id="settingsAddress" value="Sarasota, FL 34232">
                            </div>
                            <div class="form-row">
                                <div class="form-group">
                                    <label>Instagram</label>
                                    <input type="url" id="settingsInstagram" placeholder="https://instagram.com/...">
                                </div>
                                <div class="form-group">
                                    <label>Pinterest</label>
                                    <input type="url" id="settingsPinterest" placeholder="https://pinterest.com/...">
                                </div>
                            </div>
                            <button type="submit" class="btn btn-primary" style="width: auto;">Save Settings</button>
                        </form>
                    </div>

                    <div class="card">
                        <div class="card-header"><h2>Integrations</h2></div>
                        <div class="list-item">
                            <div class="list-item-header">
                                <span class="list-item-title">Calendly</span>
                                <a href="https://calendly.com/jlcstudiollc" target="_blank" class="btn btn-secondary btn-small">Open Calendly</a>
                            </div>
                            <p style="font-size: 0.85rem; color: var(--gray);">Manage bookings and availability</p>
                        </div>
                        <div class="list-item">
                            <div class="list-item-header">
                                <span class="list-item-title">Stripe</span>
                                <a href="https://dashboard.stripe.com" target="_blank" class="btn btn-secondary btn-small">Open Stripe</a>
                            </div>
                            <p style="font-size: 0.85rem; color: var(--gray);">View payments and transactions</p>
                        </div>
                    </div>

                    <div class="card">
                        <div class="card-header"><h2>Admin Credentials</h2></div>
                        <form id="credentialsForm">
                            <div class="form-row">
                                <div class="form-group">
                                    <label>Username</label>
                                    <input type="text" id="newUsername">
                                </div>
                                <div class="form-group">
                                    <label>New Password</label>
                                    <input type="password" id="newPassword">
                                </div>
                            </div>
                            <button type="submit" class="btn btn-primary" style="width: auto;">Update Credentials</button>
                        </form>
                    </div>
                </section>
            </main>
        </div>
    </div>

    <!-- Toast Notification -->
    <div class="toast" id="toast"></div>

    <script>
        // ============================================
        // SITE DATA - All editable content lives here
        // ============================================
        let siteData = {
            settings: {
                businessName: "JLC Studio",
                tagline: "Where Creativity Meets Occasion",
                phone: "(941) 769-7526",
                email: "jeremyhuffer@gmail.com",
                address: "Sarasota, FL 34232",
                instagram: "",
                pinterest: ""
            },
            hero: {
                badge: "Sarasota's Premier Creative Studio",
                titleLine1: "Where Creativity",
                titleLine2: "Meets Occasion",
                subtitle: "Florals • Event Decor • Custom Tailoring",
                description: "Every detail designed with intention for life's most important moments.",
                heroImage: "/assets/images/hero.jpg",
                primaryBtn: "Start Your Vision",
                secondaryBtn: "View Our Work"
            },
            about: {
                name: "JLynne Huffer",
                title: "Founder & Creative Director",
                photo: "/assets/images/founder.jpg",
                bio: "A multidisciplinary creative professional with over 15 years of experience spanning fashion design, event decor, and floral artistry.",
                years: 15,
                events: 500
            },
            services: [
                { category: "floral", type: "Weddings", desc: "Bridal bouquets, ceremony florals, reception centerpieces", price: "$800 - $3,500" },
                { category: "floral", type: "Corporate Events", desc: "Office arrangements, corporate galas, product launches", price: "$200 - $1,500" },
                { category: "floral", type: "Dinner Parties", desc: "Intimate gatherings, dinner party centerpieces", price: "$75 - $200" },
                { category: "decor", type: "Weddings", desc: "Complete venue transformation, ceremony to reception", price: "$2,000 - $12,000" },
                { category: "decor", type: "Galas & Fundraisers", desc: "Charity events, black-tie affairs", price: "$2,500 - $15,000" },
                { category: "decor", type: "Private Celebrations", desc: "Birthdays, anniversaries, baby showers", price: "$400 - $4,000" },
                { category: "tailoring", type: "Bridal Alterations", desc: "Wedding gown fitting, bustles, adjustments", price: "$150 - $400" },
                { category: "tailoring", type: "Custom Design", desc: "One-of-a-kind garments, special occasion wear", price: "$400 - $2,500" },
                { category: "tailoring", type: "Event Tailoring", desc: "On-site alterations, last-minute adjustments", price: "$75 - $200/hr" }
            ],
            stats: {
                monthlyBookings: 12,
                monthlyRevenue: 8500,
                upcomingEvents: 5,
                newInquiries: 8
            }
        };

        // ============================================
        // AUTHENTICATION
        // ============================================
        const CREDENTIALS = {
            username: "jlcstudio",
            password: "JLC2024!"
        };

        let authToken = null;

        function checkAuth() {
            const token = localStorage.getItem('jlc_token');
            if (token) {
                authToken = token;
                showDashboard();
            }
        }

        document.getElementById('loginForm').addEventListener('submit', function(e) {
            e.preventDefault();
            const username = document.getElementById('username').value;
            const password = document.getElementById('password').value;
            const error = document.getElementById('loginError');

            if (username === CREDENTIALS.username && password === CREDENTIALS.password) {
                authToken = 'admin_' + Date.now();
                localStorage.setItem('jlc_token', authToken);
                localStorage.setItem('jlc_user', username);
                showDashboard();
            } else {
                error.textContent = 'Invalid username or password';
                error.classList.add('show');
            }
        });

        function showDashboard() {
            document.getElementById('loginScreen').classList.add('hidden');
            document.getElementById('dashboard').classList.add('active');
            document.getElementById('welcomeUser').textContent = `Welcome, ${localStorage.getItem('jlc_user') || 'Admin'}`;
            loadData();
        }

        function logout() {
            localStorage.removeItem('jlc_token');
            localStorage.removeItem('jlc_user');
            authToken = null;
            location.reload();
        }

        // ============================================
        // NAVIGATION
        // ============================================
        document.querySelectorAll('.nav-item').forEach(item => {
            item.addEventListener('click', function() {
                const section = this.dataset.section;
                showSection(section);
            });
        });

        function showSection(sectionId) {
            document.querySelectorAll('.nav-item').forEach(n => n.classList.remove('active'));
            document.querySelector(`[data-section="${sectionId}"]`).classList.add('active');
            document.querySelectorAll('.section').forEach(s => s.classList.remove('active'));
            document.getElementById(sectionId).classList.add('active');
        }

        // ============================================
        // API FUNCTIONS - GitHub Integration
        // ============================================
        async function fetchFromGitHub(file) {
            try {
                const response = await fetch(`/_data/${file}.json?t=${Date.now()}`);
                if (response.ok) {
                    return await response.json();
                }
            } catch (e) {
                console.log(`Could not fetch ${file}, using defaults`);
            }
            return null;
        }

        async function saveToGitHub(type, data) {
            try {
                showToast('Saving...', 'info');
                const response = await fetch('/api/save-content', {
                    method: 'POST',
                    headers: {
                        'Content-Type': 'application/json',
                        'Authorization': `Bearer ${authToken}`
                    },
                    body: JSON.stringify({ type, data })
                });

                const result = await response.json();

                if (result.success) {
                    showToast(`Saved! Deploying... (${result.commit || 'pending'})`, 'success');
                    return true;
                } else {
                    showToast('Error: ' + (result.error || 'Save failed'), 'error');
                    return false;
                }
            } catch (e) {
                showToast('Network error - saving locally', 'error');
                localStorage.setItem('jlc_' + type, JSON.stringify(data));
                return false;
            }
        }

        // ============================================
        // DATA LOADING
        // ============================================
        async function loadData() {
            // Try to load from GitHub first, fall back to localStorage
            const [hero, about, settings, services] = await Promise.all([
                fetchFromGitHub('hero'),
                fetchFromGitHub('about'),
                fetchFromGitHub('settings'),
                fetchFromGitHub('services')
            ]);

            if (hero) siteData.hero = hero;
            if (about) siteData.about = about;
            if (settings) siteData.settings = settings;
            if (services) siteData.services = services;

            // Populate forms
            document.getElementById('heroBadge').value = siteData.hero.badge || '';
            document.getElementById('heroTitle1').value = siteData.hero.titleLine1 || '';
            document.getElementById('heroTitle2').value = siteData.hero.titleLine2 || '';
            document.getElementById('heroTagline').value = siteData.hero.subtitle || '';
            document.getElementById('heroDesc').value = siteData.hero.description || '';

            document.getElementById('aboutName').value = siteData.about.name || '';
            document.getElementById('aboutTitle').value = siteData.about.title || '';
            document.getElementById('aboutBio').value = siteData.about.bio || '';
            document.getElementById('aboutYears').value = siteData.about.years || 15;
            document.getElementById('aboutEvents').value = siteData.about.events || 500;

            document.getElementById('settingsPhone').value = siteData.settings.phone || '';
            document.getElementById('settingsEmail').value = siteData.settings.email || '';
            document.getElementById('settingsAddress').value = siteData.settings.address || '';
            document.getElementById('settingsInstagram').value = siteData.settings.instagram || '';
            document.getElementById('settingsPinterest').value = siteData.settings.pinterest || '';

            // Stats
            document.getElementById('monthlyBookings').textContent = siteData.stats.monthlyBookings;
            document.getElementById('monthlyRevenue').textContent = '$' + siteData.stats.monthlyRevenue.toLocaleString();
            document.getElementById('upcomingEvents').textContent = siteData.stats.upcomingEvents;
            document.getElementById('newInquiries').textContent = siteData.stats.newInquiries;

            // Load pricing by category
            const floral = (siteData.services || []).filter(s => s.category === 'floral');
            const decor = (siteData.services || []).filter(s => s.category === 'decor');
            const tailoring = (siteData.services || []).filter(s => s.category === 'tailoring');
            renderPricing('floral', floral);
            renderPricing('decor', decor);
            renderPricing('tailoring', tailoring);
        }

        // ============================================
        // FORM HANDLERS
        // ============================================
        document.getElementById('heroForm').addEventListener('submit', async function(e) {
            e.preventDefault();
            const heroData = {
                badge: document.getElementById('heroBadge').value,
                titleLine1: document.getElementById('heroTitle1').value,
                titleLine2: document.getElementById('heroTitle2').value,
                subtitle: document.getElementById('heroTagline').value,
                description: document.getElementById('heroDesc').value,
                heroImage: siteData.hero.heroImage || '/assets/images/hero.jpg',
                primaryBtn: siteData.hero.primaryBtn || 'Start Your Vision',
                secondaryBtn: siteData.hero.secondaryBtn || 'View Our Work'
            };
            siteData.hero = heroData;
            await saveToGitHub('hero', heroData);
        });

        document.getElementById('aboutForm').addEventListener('submit', async function(e) {
            e.preventDefault();
            const aboutData = {
                name: document.getElementById('aboutName').value,
                title: document.getElementById('aboutTitle').value,
                bio: document.getElementById('aboutBio').value,
                years: parseInt(document.getElementById('aboutYears').value),
                events: parseInt(document.getElementById('aboutEvents').value),
                photo: siteData.about.photo || '/assets/images/founder.jpg'
            };
            siteData.about = aboutData;
            await saveToGitHub('about', aboutData);
        });

        document.getElementById('settingsForm').addEventListener('submit', async function(e) {
            e.preventDefault();
            const settingsData = {
                businessName: siteData.settings.businessName || 'JLC Studio',
                tagline: siteData.settings.tagline || 'Where Creativity Meets Occasion',
                phone: document.getElementById('settingsPhone').value,
                email: document.getElementById('settingsEmail').value,
                address: document.getElementById('settingsAddress').value,
                instagram: document.getElementById('settingsInstagram').value,
                pinterest: document.getElementById('settingsPinterest').value
            };
            siteData.settings = settingsData;
            await saveToGitHub('settings', settingsData);
        });

        // ============================================
        // PRICING MANAGEMENT
        // ============================================
        function renderPricing(category, items) {
            const container = document.getElementById(category + 'Pricing');
            if (!container) return;
            container.innerHTML = items.map((item, i) => `
                <div class="list-item">
                    <div class="form-row">
                        <input type="text" value="${item.type || ''}" placeholder="Service type"
                               onchange="updatePricing('${category}', ${i}, 'type', this.value)">
                        <input type="text" value="${item.price || ''}" placeholder="Price"
                               onchange="updatePricing('${category}', ${i}, 'price', this.value)">
                    </div>
                    <input type="text" value="${item.desc || ''}" placeholder="Description"
                           style="margin-top: 0.5rem" onchange="updatePricing('${category}', ${i}, 'desc', this.value)">
                </div>
            `).join('');
        }

        function updatePricing(category, index, field, value) {
            // Find items in this category
            const categoryItems = siteData.services.filter(s => s.category === category);
            if (categoryItems[index]) {
                categoryItems[index][field] = value;
                saveServices();
            }
        }

        function addPricing(category) {
            siteData.services.push({ category: category, type: "", desc: "", price: "" });
            const categoryItems = siteData.services.filter(s => s.category === category);
            renderPricing(category, categoryItems);
        }

        async function saveServices() {
            await saveToGitHub('services', siteData.services);
        }

        // ============================================
        // UTILITIES
        // ============================================
        function showToast(message, type = 'success') {
            const toast = document.getElementById('toast');
            toast.textContent = message;
            toast.className = 'toast ' + type + ' show';
            setTimeout(() => toast.classList.remove('show'), 3000);
        }

        function previewImage(input, previewId) {
            if (input.files && input.files[0]) {
                const reader = new FileReader();
                reader.onload = function(e) {
                    const preview = document.getElementById(previewId);
                    preview.src = e.target.result;
                    preview.style.display = 'block';
                };
                reader.readAsDataURL(input.files[0]);
            }
        }

        // Initialize
        checkAuth();
    </script>
</body>
</html>
