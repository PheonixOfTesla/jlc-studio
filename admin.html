<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>JLC Studio - Admin Dashboard</title>
    <link href="https://fonts.googleapis.com/css2?family=Cormorant+Garamond:wght@500;600&family=Montserrat:wght@400;500;600&display=swap" rel="stylesheet">
    <style>
        * { margin: 0; padding: 0; box-sizing: border-box; }
        :root {
            --primary: #C4A052;
            --primary-dark: #A68A42;
            --accent: #F5E6E0;
            --dark: #1a1a1a;
            --text: #333;
            --text-light: #666;
            --bg: #fafaf8;
            --white: #fff;
            --success: #7D9B76;
            --error: #C45B5B;
            --border: #e5e5e5;
        }
        body { font-family: 'Montserrat', sans-serif; background: var(--bg); min-height: 100vh; color: var(--text); }

        /* LOGIN */
        .login-screen { min-height: 100vh; display: flex; align-items: center; justify-content: center; background: linear-gradient(135deg, var(--dark) 0%, #2d2d2d 100%); }
        .login-screen.hidden { display: none; }
        .login-box { background: var(--white); padding: 3rem; border-radius: 16px; width: 100%; max-width: 400px; box-shadow: 0 20px 60px rgba(0,0,0,0.3); }
        .login-logo { font-family: 'Cormorant Garamond', serif; font-size: 2rem; color: var(--primary); text-align: center; margin-bottom: 0.5rem; }
        .login-subtitle { text-align: center; color: var(--text-light); font-size: 0.9rem; margin-bottom: 2rem; }
        .error-msg { background: #fef2f2; color: var(--error); padding: 1rem; border-radius: 8px; margin-bottom: 1rem; display: none; font-size: 0.9rem; }
        .error-msg.show { display: block; }

        /* FORMS */
        .form-group { margin-bottom: 1.25rem; }
        .form-group label { display: block; font-size: 0.8rem; font-weight: 600; margin-bottom: 0.5rem; color: var(--text); text-transform: uppercase; letter-spacing: 0.05em; }
        .form-group input, .form-group textarea, .form-group select { width: 100%; padding: 0.875rem 1rem; border: 2px solid var(--border); border-radius: 8px; font-size: 0.95rem; font-family: inherit; transition: all 0.2s; background: var(--white); }
        .form-group input:focus, .form-group textarea:focus, .form-group select:focus { outline: none; border-color: var(--primary); box-shadow: 0 0 0 3px rgba(196,160,82,0.1); }
        .form-group textarea { resize: vertical; min-height: 100px; }
        .form-row { display: grid; grid-template-columns: 1fr 1fr; gap: 1rem; }
        .form-row-3 { display: grid; grid-template-columns: 1fr 1fr 1fr; gap: 1rem; }
        .form-hint { font-size: 0.75rem; color: var(--text-light); margin-top: 0.25rem; }

        /* BUTTONS */
        .btn { display: inline-flex; align-items: center; justify-content: center; gap: 0.5rem; padding: 0.875rem 1.5rem; border: none; border-radius: 8px; font-size: 0.9rem; font-weight: 600; cursor: pointer; transition: all 0.2s; font-family: inherit; }
        .btn-primary { background: var(--primary); color: var(--white); }
        .btn-primary:hover { background: var(--primary-dark); transform: translateY(-1px); }
        .btn-save { background: var(--success); color: var(--white); }
        .btn-save:hover { background: #6a8965; }
        .btn-outline { background: transparent; border: 2px solid var(--border); color: var(--text); }
        .btn-outline:hover { border-color: var(--primary); color: var(--primary); }
        .btn-danger { background: var(--error); color: var(--white); }
        .btn-small { padding: 0.5rem 1rem; font-size: 0.8rem; }
        .btn-block { width: 100%; }

        /* DASHBOARD */
        .dashboard { display: none; }
        .dashboard.active { display: flex; min-height: 100vh; }

        /* SIDEBAR */
        .sidebar { width: 280px; background: var(--dark); color: var(--white); position: fixed; height: 100vh; overflow-y: auto; }
        .sidebar-header { padding: 1.5rem; border-bottom: 1px solid rgba(255,255,255,0.1); }
        .sidebar-logo { font-family: 'Cormorant Garamond', serif; font-size: 1.5rem; color: var(--primary); }
        .sidebar-user { font-size: 0.8rem; color: rgba(255,255,255,0.6); margin-top: 0.25rem; }
        .sidebar-section { padding: 0.75rem 1.5rem 0.5rem; font-size: 0.65rem; text-transform: uppercase; letter-spacing: 0.15em; color: rgba(255,255,255,0.4); margin-top: 0.5rem; }
        .nav-item { display: flex; align-items: center; gap: 0.75rem; padding: 0.875rem 1.5rem; color: rgba(255,255,255,0.7); text-decoration: none; font-size: 0.9rem; border-left: 3px solid transparent; cursor: pointer; transition: all 0.2s; }
        .nav-item:hover { background: rgba(255,255,255,0.05); color: var(--white); }
        .nav-item.active { background: rgba(196,160,82,0.15); color: var(--primary); border-left-color: var(--primary); }
        .nav-item svg { width: 18px; height: 18px; stroke: currentColor; fill: none; stroke-width: 2; flex-shrink: 0; }
        .sidebar-footer { padding: 1.5rem; border-top: 1px solid rgba(255,255,255,0.1); margin-top: auto; }
        .logout-btn { width: 100%; padding: 0.75rem; background: rgba(255,255,255,0.1); border: none; color: var(--white); border-radius: 8px; cursor: pointer; font-size: 0.85rem; font-family: inherit; transition: all 0.2s; }
        .logout-btn:hover { background: rgba(255,255,255,0.15); }

        /* MAIN CONTENT */
        .main-content { flex: 1; margin-left: 280px; padding: 2rem; max-width: calc(100vw - 280px); }
        .page-header { margin-bottom: 2rem; }
        .page-header h1 { font-family: 'Cormorant Garamond', serif; font-size: 2rem; font-weight: 600; margin-bottom: 0.25rem; }
        .page-header p { color: var(--text-light); font-size: 0.9rem; }

        /* CARDS */
        .card { background: var(--white); border-radius: 12px; padding: 1.5rem; margin-bottom: 1.5rem; box-shadow: 0 1px 3px rgba(0,0,0,0.04); border: 1px solid var(--border); }
        .card-header { display: flex; justify-content: space-between; align-items: center; margin-bottom: 1.25rem; padding-bottom: 1rem; border-bottom: 1px solid var(--border); }
        .card-header h3 { font-size: 1rem; font-weight: 600; }
        .card-grid { display: grid; grid-template-columns: repeat(auto-fit, minmax(280px, 1fr)); gap: 1.5rem; }

        /* SECTIONS */
        .section { display: none; }
        .section.active { display: block; }

        /* STATUS */
        .status { display: inline-flex; align-items: center; gap: 0.5rem; font-size: 0.8rem; padding: 0.35rem 0.75rem; border-radius: 20px; font-weight: 500; }
        .status-connected { background: rgba(125,155,118,0.15); color: var(--success); }
        .status-connected::before { content: ''; width: 6px; height: 6px; background: var(--success); border-radius: 50%; }

        /* ITEMS */
        .item-list { display: flex; flex-direction: column; gap: 0.75rem; }
        .item { background: var(--bg); padding: 1.25rem; border-radius: 8px; border: 1px solid var(--border); }
        .item-header { display: flex; justify-content: space-between; align-items: flex-start; margin-bottom: 0.75rem; }
        .item-number { font-size: 0.7rem; font-weight: 600; color: var(--primary); text-transform: uppercase; letter-spacing: 0.1em; }
        .delete-btn { background: none; border: none; color: var(--error); cursor: pointer; font-size: 0.8rem; padding: 0.25rem 0.5rem; border-radius: 4px; }
        .delete-btn:hover { background: rgba(196,91,91,0.1); }

        /* COLOR PICKER */
        .color-grid { display: grid; grid-template-columns: repeat(5, 1fr); gap: 0.75rem; margin-bottom: 1.5rem; }
        .color-swatch { aspect-ratio: 1; border-radius: 8px; cursor: pointer; border: 3px solid transparent; transition: all 0.2s; position: relative; }
        .color-swatch:hover { transform: scale(1.05); }
        .color-swatch.active { border-color: var(--dark); }
        .color-swatch.active::after { content: ''; position: absolute; inset: 0; display: flex; align-items: center; justify-content: center; color: white; font-size: 1.25rem; text-shadow: 0 1px 2px rgba(0,0,0,0.3); }
        .color-input-group { display: flex; gap: 0.5rem; align-items: center; }
        .color-input-group input[type="color"] { width: 50px; height: 40px; border: none; border-radius: 8px; cursor: pointer; }
        .color-input-group input[type="text"] { flex: 1; }
        .rgb-display { font-family: monospace; font-size: 0.85rem; color: var(--text-light); }

        /* STATS */
        .stats-grid { display: grid; grid-template-columns: repeat(auto-fit, minmax(200px, 1fr)); gap: 1rem; margin-bottom: 1.5rem; }
        .stat-card { background: var(--white); border-radius: 12px; padding: 1.25rem; border: 1px solid var(--border); }
        .stat-label { font-size: 0.75rem; text-transform: uppercase; letter-spacing: 0.1em; color: var(--text-light); margin-bottom: 0.5rem; }
        .stat-value { font-size: 1.75rem; font-weight: 600; color: var(--dark); font-family: 'Cormorant Garamond', serif; }
        .stat-note { font-size: 0.8rem; color: var(--text-light); margin-top: 0.25rem; }

        /* TOAST */
        .toast { position: fixed; bottom: 2rem; right: 2rem; padding: 1rem 1.5rem; background: var(--dark); color: var(--white); border-radius: 8px; box-shadow: 0 4px 20px rgba(0,0,0,0.2); transform: translateY(100px); opacity: 0; transition: all 0.3s; z-index: 1000; display: flex; align-items: center; gap: 0.75rem; }
        .toast.show { transform: translateY(0); opacity: 1; }
        .toast.success { background: var(--success); }
        .toast.error { background: var(--error); }

        /* IMAGE UPLOAD */
        .image-upload { border: 2px dashed var(--border); border-radius: 8px; padding: 2rem; text-align: center; cursor: pointer; transition: all 0.2s; }
        .image-upload:hover { border-color: var(--primary); background: rgba(196,160,82,0.05); }
        .image-preview { width: 100%; max-height: 200px; object-fit: cover; border-radius: 8px; margin-bottom: 1rem; }

        /* INCLUDES LIST */
        .includes-list { display: flex; flex-wrap: wrap; gap: 0.5rem; margin-top: 0.5rem; }
        .include-tag { background: rgba(196,160,82,0.15); color: var(--primary-dark); padding: 0.35rem 0.75rem; border-radius: 20px; font-size: 0.8rem; display: flex; align-items: center; gap: 0.5rem; }
        .include-tag button { background: none; border: none; color: inherit; cursor: pointer; font-size: 1rem; line-height: 1; }

        /* PHOTO GRID */
        .photo-grid { display: grid; grid-template-columns: repeat(auto-fill, minmax(200px, 1fr)); gap: 1rem; }
        .photo-card { background: var(--bg); border: 1px solid var(--border); border-radius: 8px; overflow: hidden; cursor: pointer; transition: all 0.2s; }
        .photo-card:hover { border-color: var(--primary); box-shadow: 0 4px 12px rgba(0,0,0,0.1); }
        .photo-card img { width: 100%; height: 120px; object-fit: cover; display: block; }
        .photo-card-info { padding: 0.75rem; }
        .photo-card-label { font-size: 0.8rem; font-weight: 600; color: var(--text); margin-bottom: 0.25rem; }
        .photo-card-desc { font-size: 0.7rem; color: var(--text-light); }
        .photo-card-page { font-size: 0.65rem; color: var(--primary); margin-top: 0.25rem; }
        .photo-modal { position: fixed; inset: 0; background: rgba(0,0,0,0.8); display: none; align-items: center; justify-content: center; z-index: 2000; padding: 2rem; }
        .photo-modal.show { display: flex; }
        .photo-modal-content { background: var(--white); border-radius: 12px; padding: 1.5rem; width: 100%; max-width: 500px; }
        .photo-modal-preview { width: 100%; height: 200px; object-fit: cover; border-radius: 8px; margin-bottom: 1rem; }
        .photo-modal-close { position: absolute; top: 1rem; right: 1rem; background: var(--white); border: none; width: 36px; height: 36px; border-radius: 50%; cursor: pointer; font-size: 1.25rem; }

        /* PREVIEW SECTION */
        .preview-tabs { display: flex; gap: 0.5rem; margin-bottom: 1.5rem; border-bottom: 2px solid var(--border); padding-bottom: 0.5rem; flex-wrap: wrap; }
        .preview-tab { padding: 0.75rem 1.5rem; background: transparent; border: none; font-family: inherit; font-size: 0.9rem; font-weight: 500; color: var(--text-light); cursor: pointer; border-radius: 8px 8px 0 0; transition: all 0.2s; }
        .preview-tab.active { background: var(--primary); color: var(--white); }
        .preview-tab:hover:not(.active) { background: rgba(196,160,82,0.1); }
        .preview-container { background: var(--white); border-radius: 12px; border: 1px solid var(--border); overflow: hidden; margin-bottom: 5rem; }
        .preview-page { display: none; padding: 1.5rem; }
        .preview-page.active { display: block; }
        .preview-section { margin-bottom: 2rem; padding-bottom: 2rem; border-bottom: 1px solid var(--border); }
        .preview-section:last-child { margin-bottom: 0; padding-bottom: 0; border-bottom: none; }
        .preview-section-header { display: flex; justify-content: space-between; align-items: center; margin-bottom: 1rem; }
        .preview-section-header h3 { font-size: 0.9rem; font-weight: 600; color: var(--primary); text-transform: uppercase; letter-spacing: 0.1em; }
        .editable-wrapper { position: relative; display: inline-block; }
        .editable-wrapper:hover .edit-btn { opacity: 1; }
        .edit-btn { position: absolute; top: -8px; right: -28px; width: 22px; height: 22px; background: var(--primary); border: none; border-radius: 50%; color: white; cursor: pointer; opacity: 0; transition: all 0.2s; display: flex; align-items: center; justify-content: center; box-shadow: 0 2px 8px rgba(0,0,0,0.2); z-index: 10; font-size: 10px; }
        .edit-btn:hover { background: var(--primary-dark); transform: scale(1.1); }
        .editable-text { outline: none; border: 2px dashed transparent; padding: 4px 8px; margin: -4px -8px; border-radius: 4px; transition: border-color 0.2s; min-width: 20px; }
        .editable-text:hover { border-color: rgba(196,160,82,0.3); }
        .editable-text:focus { border-color: var(--primary); background: rgba(196,160,82,0.05); }
        .editable-text.modified { background: rgba(196,160,82,0.15); }
        .preview-hero-mock { background: linear-gradient(135deg, #1a1a1a 0%, #2d2d2d 100%); border-radius: 12px; padding: 2.5rem; text-align: center; color: white; }
        .preview-hero-badge { display: inline-block; padding: 0.4rem 0.8rem; background: rgba(255,255,255,0.1); border: 1px solid rgba(255,255,255,0.2); border-radius: 50px; font-size: 0.65rem; letter-spacing: 0.15em; text-transform: uppercase; margin-bottom: 0.75rem; }
        .preview-hero-title { font-family: 'Cormorant Garamond', serif; font-size: 1.75rem; margin-bottom: 0.75rem; line-height: 1.2; }
        .preview-hero-title .line2 { color: #C4A052; font-style: italic; }
        .preview-hero-subtitle { font-family: 'Cormorant Garamond', serif; font-size: 0.9rem; letter-spacing: 0.15em; text-transform: uppercase; margin-bottom: 0.5rem; color: rgba(255,255,255,0.9); }
        .preview-hero-description { font-size: 0.8rem; color: rgba(255,255,255,0.7); max-width: 400px; margin: 0 auto 1rem; }
        .preview-hero-buttons { display: flex; gap: 0.75rem; justify-content: center; flex-wrap: wrap; }
        .preview-btn-primary { padding: 0.6rem 1.2rem; background: #C4A052; color: white; border-radius: 4px; font-size: 0.7rem; letter-spacing: 0.1em; text-transform: uppercase; }
        .preview-btn-outline { padding: 0.6rem 1.2rem; background: transparent; color: white; border: 1px solid rgba(255,255,255,0.5); border-radius: 4px; font-size: 0.7rem; letter-spacing: 0.1em; text-transform: uppercase; }
        .preview-save-bar { position: fixed; bottom: 0; left: 280px; right: 0; background: var(--white); padding: 1rem 2rem; border-top: 1px solid var(--border); display: flex; justify-content: flex-end; align-items: center; gap: 1rem; box-shadow: 0 -4px 20px rgba(0,0,0,0.1); z-index: 100; }
        .unsaved-indicator { color: var(--error); font-size: 0.85rem; font-weight: 500; display: flex; align-items: center; gap: 0.5rem; }
        .unsaved-indicator::before { content: ''; width: 8px; height: 8px; background: var(--error); border-radius: 50%; animation: pulse 1.5s infinite; }
        @keyframes pulse { 0%, 100% { opacity: 1; } 50% { opacity: 0.5; } }
        .preview-services-grid { display: grid; grid-template-columns: repeat(auto-fill, minmax(200px, 1fr)); gap: 1rem; }
        .preview-service-card { background: #fafaf8; border: 1px solid #e5e5e5; border-radius: 8px; padding: 1rem; transition: all 0.2s; }
        .preview-service-card:hover { border-color: var(--primary); }
        .preview-service-card h4 { font-size: 0.9rem; margin-bottom: 0.5rem; display: flex; justify-content: space-between; align-items: center; }
        .preview-service-card p { font-size: 0.75rem; color: var(--text-light); margin-bottom: 0.5rem; line-height: 1.4; }
        .preview-service-card .price { font-size: 0.8rem; color: var(--primary); font-weight: 600; }
        .preview-about-mock { background: #fafaf8; border-radius: 12px; padding: 1.5rem; }
        .preview-testimonials { display: flex; gap: 1rem; overflow-x: auto; padding-bottom: 0.5rem; }
        .preview-testimonial-card { flex: 0 0 250px; background: #fafaf8; border-radius: 8px; padding: 1.25rem; }
        .preview-testimonial-quote { font-style: italic; font-size: 0.8rem; margin-bottom: 0.75rem; line-height: 1.5; color: var(--text); }
        .preview-testimonial-author { display: flex; align-items: center; gap: 0.6rem; }
        .preview-author-avatar { width: 32px; height: 32px; background: #8B9B7A; border-radius: 50%; display: flex; align-items: center; justify-content: center; color: white; font-size: 0.6rem; font-weight: 600; }
        .preview-author-name { font-size: 0.8rem; font-weight: 600; }
        .preview-author-event { font-size: 0.7rem; color: var(--text-light); }
        .preview-faq-list { display: flex; flex-direction: column; gap: 0.75rem; }
        .preview-faq-item { background: #fafaf8; border-radius: 8px; padding: 1rem; }
        .preview-faq-question { font-weight: 600; font-size: 0.85rem; margin-bottom: 0.5rem; display: flex; justify-content: space-between; align-items: start; gap: 1rem; }
        .preview-faq-answer { font-size: 0.8rem; color: var(--text-light); line-height: 1.5; }
        .preview-contact-grid { display: grid; grid-template-columns: repeat(auto-fit, minmax(200px, 1fr)); gap: 1rem; }
        .preview-contact-item { background: #fafaf8; border-radius: 8px; padding: 1rem; }
        .preview-contact-label { font-size: 0.7rem; text-transform: uppercase; letter-spacing: 0.1em; color: var(--text-light); margin-bottom: 0.25rem; }
        .preview-contact-value { font-size: 0.9rem; font-weight: 500; }
        .edit-modal { position: fixed; inset: 0; background: rgba(0,0,0,0.6); display: none; align-items: center; justify-content: center; z-index: 2000; padding: 2rem; }
        .edit-modal.show { display: flex; }
        .edit-modal-content { background: white; border-radius: 12px; padding: 1.5rem; width: 100%; max-width: 500px; max-height: 80vh; overflow-y: auto; }
        .edit-modal-header { display: flex; justify-content: space-between; align-items: center; margin-bottom: 1.5rem; }
        .edit-modal-header h3 { font-size: 1.1rem; font-weight: 600; }
        .edit-modal-close { background: none; border: none; font-size: 1.5rem; cursor: pointer; color: var(--text-light); line-height: 1; }
        .edit-modal-actions { display: flex; gap: 1rem; margin-top: 1.5rem; flex-wrap: wrap; }

        @media (max-width: 900px) {
            .sidebar { width: 100%; height: auto; position: relative; }
            .main-content { margin-left: 0; max-width: 100%; }
            .dashboard.active { flex-direction: column; }
            .form-row, .form-row-3 { grid-template-columns: 1fr; }
            .color-grid { grid-template-columns: repeat(5, 1fr); }
            .preview-save-bar { left: 0; }
            .edit-btn { opacity: 1; }
            .preview-services-grid { grid-template-columns: 1fr; }
        }
    </style>
</head>
<body>
    <!-- LOGIN -->
    <div class="login-screen" id="loginScreen">
        <div class="login-box">
            <div class="login-logo">JLC Studio</div>
            <div class="login-subtitle">Admin Dashboard</div>
            <div class="error-msg" id="loginError"></div>
            <form id="loginForm">
                <div class="form-group">
                    <label>Username</label>
                    <input type="text" id="username" required autocomplete="username">
                </div>
                <div class="form-group">
                    <label>Password</label>
                    <input type="password" id="password" required autocomplete="current-password">
                </div>
                <button type="submit" class="btn btn-primary btn-block">Sign In</button>
            </form>
        </div>
    </div>

    <!-- DASHBOARD -->
    <div class="dashboard" id="dashboard">
        <aside class="sidebar">
            <div class="sidebar-header">
                <div class="sidebar-logo">JLC Studio</div>
                <div class="sidebar-user">Welcome, JLynne</div>
            </div>

            <div class="sidebar-section">Visual Editor</div>
            <a class="nav-item active" data-section="preview">
                <svg viewBox="0 0 24 24"><rect x="2" y="3" width="20" height="14" rx="2"/><line x1="8" y1="21" x2="16" y2="21"/><line x1="12" y1="17" x2="12" y2="21"/></svg>
                Preview & Edit
            </a>

            <div class="sidebar-section">Website Content</div>
            <a class="nav-item" data-section="hero">
                <svg viewBox="0 0 24 24"><rect x="3" y="3" width="18" height="18" rx="2"/><line x1="3" y1="9" x2="21" y2="9"/></svg>
                Hero Banner
            </a>
            <a class="nav-item" data-section="about">
                <svg viewBox="0 0 24 24"><circle cx="12" cy="8" r="4"/><path d="M20 21v-2a4 4 0 0 0-4-4H8a4 4 0 0 0-4 4v2"/></svg>
                About / Bio
            </a>
            <a class="nav-item" data-section="services">
                <svg viewBox="0 0 24 24"><path d="M12 2L2 7l10 5 10-5-10-5z"/><path d="M2 17l10 5 10-5"/><path d="M2 12l10 5 10-5"/></svg>
                Services & Pricing
            </a>
            <a class="nav-item" data-section="packages">
                <svg viewBox="0 0 24 24"><path d="M21 16V8a2 2 0 0 0-1-1.73l-7-4a2 2 0 0 0-2 0l-7 4A2 2 0 0 0 3 8v8a2 2 0 0 0 1 1.73l7 4a2 2 0 0 0 2 0l7-4A2 2 0 0 0 21 16z"/></svg>
                Packages
            </a>
            <a class="nav-item" data-section="testimonials">
                <svg viewBox="0 0 24 24"><path d="M21 15a2 2 0 0 1-2 2H7l-4 4V5a2 2 0 0 1 2-2h14a2 2 0 0 1 2 2z"/></svg>
                Testimonials
            </a>
            <a class="nav-item" data-section="faq">
                <svg viewBox="0 0 24 24"><circle cx="12" cy="12" r="10"/><path d="M9.09 9a3 3 0 0 1 5.83 1c0 2-3 3-3 3"/><line x1="12" y1="17" x2="12.01" y2="17"/></svg>
                FAQ
            </a>
            <a class="nav-item" data-section="contact">
                <svg viewBox="0 0 24 24"><path d="M4 4h16c1.1 0 2 .9 2 2v12c0 1.1-.9 2-2 2H4c-1.1 0-2-.9-2-2V6c0-1.1.9-2 2-2z"/><polyline points="22,6 12,13 2,6"/></svg>
                Contact Info
            </a>

            <div class="sidebar-section">Appearance</div>
            <a class="nav-item" data-section="photos">
                <svg viewBox="0 0 24 24"><rect x="3" y="3" width="18" height="18" rx="2"/><circle cx="8.5" cy="8.5" r="1.5"/><polyline points="21 15 16 10 5 21"/></svg>
                Photos
            </a>
            <a class="nav-item" data-section="theme">
                <svg viewBox="0 0 24 24"><circle cx="13.5" cy="6.5" r="2.5"/><circle cx="17.5" cy="10.5" r="2.5"/><circle cx="8.5" cy="7.5" r="2.5"/><circle cx="6.5" cy="12.5" r="2.5"/><path d="M12 2C6.5 2 2 6.5 2 12s4.5 10 10 10c.93 0 1.73-.67 1.9-1.57.1-.56-.09-1.14-.48-1.54-.39-.4-.58-.96-.48-1.54.17-.9.97-1.56 1.88-1.56H17c2.76 0 5-2.24 5-5 0-4.42-4.03-8.79-10-8.79z"/></svg>
                Color Theme
            </a>

            <div class="sidebar-section">Business</div>
            <a class="nav-item" data-section="team">
                <svg viewBox="0 0 24 24"><path d="M17 21v-2a4 4 0 0 0-4-4H5a4 4 0 0 0-4 4v2"/><circle cx="9" cy="7" r="4"/><path d="M23 21v-2a4 4 0 0 0-3-3.87"/><path d="M16 3.13a4 4 0 0 1 0 7.75"/></svg>
                Team Members
            </a>
            <a class="nav-item" data-section="awards">
                <svg viewBox="0 0 24 24"><path d="M6 9H4a2 2 0 0 0-2 2v12a2 2 0 0 0 2 2h16a2 2 0 0 0 2-2V11a2 2 0 0 0-2-2h-2m-4-3V5a2 2 0 0 0-2-2h-4a2 2 0 0 0-2 2v1m4-3h4"/><path d="M12 15v6M9 18h6"/></svg>
                Awards & Press
            </a>
            <a class="nav-item" data-section="blog">
                <svg viewBox="0 0 24 24"><path d="M4 4h16v2H4V4zm0 4h16v10H4V8zm0 12h16v2H4v-2z"/><line x1="6" y1="10" x2="14" y2="10"/><line x1="6" y1="14" x2="14" y2="14"/></svg>
                Blog & Articles
            </a>
            <a class="nav-item" data-section="casestudies">
                <svg viewBox="0 0 24 24"><rect x="2" y="3" width="20" height="14" rx="2"/><line x1="2" y1="9" x2="22" y2="9"/><line x1="2" y1="17" x2="22" y2="17"/></svg>
                Case Studies
            </a>
            <a class="nav-item" data-section="promotions">
                <svg viewBox="0 0 24 24"><path d="M3 9l9-7 9 7v11a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2z"/><polyline points="9 22 9 12 15 12 15 22"/><path d="M9 12L6.5 8.5M15 12l2.5-3.5"/></svg>
                Promotions
            </a>
            <a class="nav-item" data-section="analytics">
                <svg viewBox="0 0 24 24"><line x1="18" y1="20" x2="18" y2="10"/><line x1="12" y1="20" x2="12" y2="4"/><line x1="6" y1="20" x2="6" y2="14"/></svg>
                Analytics
            </a>
            <a class="nav-item" data-section="integrations">
                <svg viewBox="0 0 24 24"><rect x="3" y="4" width="18" height="18" rx="2"/><line x1="16" y1="2" x2="16" y2="6"/><line x1="8" y1="2" x2="8" y2="6"/><line x1="3" y1="10" x2="21" y2="10"/></svg>
                Calendly & Stripe
            </a>

            <div class="sidebar-footer">
                <button class="logout-btn" onclick="logout()">Sign Out</button>
            </div>
        </aside>

        <main class="main-content">
            <!-- PREVIEW & EDIT -->
            <section id="preview" class="section active">
                <div class="page-header">
                    <h1>Preview & Edit</h1>
                    <p>See your site content and edit text directly</p>
                </div>

                <div class="preview-tabs">
                    <button class="preview-tab active" data-page="home">Homepage</button>
                    <button class="preview-tab" data-page="services">Services</button>
                    <button class="preview-tab" data-page="contact">Contact</button>
                </div>

                <div class="preview-container">
                    <div class="preview-page active" id="preview-home"></div>
                    <div class="preview-page" id="preview-services"></div>
                    <div class="preview-page" id="preview-contact"></div>
                </div>

                <div class="preview-save-bar" id="previewSaveBar" style="display:none">
                    <span class="unsaved-indicator">Unsaved changes</span>
                    <button class="btn btn-save" onclick="saveAllPreviewChanges()">Save All Changes</button>
                </div>
            </section>

            <!-- HERO -->
            <section id="hero" class="section">
                <div class="page-header">
                    <h1>Hero Banner</h1>
                    <p>Edit the main banner that visitors see first on your homepage</p>
                </div>
                <div class="card">
                    <form id="heroForm">
                        <div class="form-group">
                            <label>Badge Text</label>
                            <input type="text" id="heroBadge" placeholder="e.g., Sarasota's Premier Creative Studio">
                            <div class="form-hint">Small text that appears above the main title</div>
                        </div>
                        <div class="form-row">
                            <div class="form-group">
                                <label>Title Line 1</label>
                                <input type="text" id="heroTitle1" placeholder="Where Creativity">
                            </div>
                            <div class="form-group">
                                <label>Title Line 2</label>
                                <input type="text" id="heroTitle2" placeholder="Meets Occasion">
                            </div>
                        </div>
                        <div class="form-group">
                            <label>Subtitle</label>
                            <input type="text" id="heroSubtitle" placeholder="Florals - Event Decor - Custom Tailoring">
                        </div>
                        <div class="form-group">
                            <label>Description</label>
                            <textarea id="heroDesc" rows="2" placeholder="Every detail designed with intention..."></textarea>
                        </div>
                        <div class="form-row">
                            <div class="form-group">
                                <label>Primary Button Text</label>
                                <input type="text" id="heroBtnPrimary" placeholder="Start Your Vision">
                            </div>
                            <div class="form-group">
                                <label>Secondary Button Text</label>
                                <input type="text" id="heroBtnSecondary" placeholder="View Our Work">
                            </div>
                        </div>
                        <div class="form-group">
                            <label>Hero Image URL</label>
                            <input type="text" id="heroImage" placeholder="/assets/images/hero.jpg">
                            <div class="form-hint">Enter image path or URL</div>
                        </div>
                        <button type="submit" class="btn btn-save">Save Hero Section</button>
                    </form>
                </div>
            </section>

            <!-- ABOUT -->
            <section id="about" class="section">
                <div class="page-header">
                    <h1>About / Bio</h1>
                    <p>Edit your personal information and professional bio</p>
                </div>
                <div class="card">
                    <form id="aboutForm">
                        <div class="form-row">
                            <div class="form-group">
                                <label>Your Name</label>
                                <input type="text" id="aboutName" placeholder="JLynne Huffer">
                            </div>
                            <div class="form-group">
                                <label>Professional Title</label>
                                <input type="text" id="aboutTitle" placeholder="Founder & Creative Director">
                            </div>
                        </div>
                        <div class="form-group">
                            <label>Bio / About Text</label>
                            <textarea id="aboutBio" rows="5" placeholder="Your professional background and story..."></textarea>
                        </div>
                        <div class="form-row">
                            <div class="form-group">
                                <label>Years of Experience</label>
                                <input type="number" id="aboutYears" placeholder="15">
                            </div>
                            <div class="form-group">
                                <label>Events Created</label>
                                <input type="number" id="aboutEvents" placeholder="500">
                            </div>
                        </div>
                        <div class="form-group">
                            <label>Profile Photo URL</label>
                            <input type="text" id="aboutPhoto" placeholder="/assets/images/jlynne.jpg">
                        </div>
                        <button type="submit" class="btn btn-save">Save About Section</button>
                    </form>
                </div>
            </section>

            <!-- SERVICES -->
            <section id="services" class="section">
                <div class="page-header">
                    <h1>Services & Pricing</h1>
                    <p>Manage your service offerings and pricing</p>
                </div>

                <div class="card">
                    <div class="card-header">
                        <h3>Floral Design Services</h3>
                        <button type="button" class="btn btn-outline btn-small" onclick="addService('floral')">+ Add Service</button>
                    </div>
                    <div class="item-list" id="floralServices"></div>
                </div>

                <div class="card">
                    <div class="card-header">
                        <h3>Event Decor Services</h3>
                        <button type="button" class="btn btn-outline btn-small" onclick="addService('decor')">+ Add Service</button>
                    </div>
                    <div class="item-list" id="decorServices"></div>
                </div>

                <div class="card">
                    <div class="card-header">
                        <h3>Custom Tailoring Services</h3>
                        <button type="button" class="btn btn-outline btn-small" onclick="addService('tailoring')">+ Add Service</button>
                    </div>
                    <div class="item-list" id="tailoringServices"></div>
                </div>

                <button type="button" class="btn btn-save" onclick="saveServices()">Save All Services</button>
            </section>

            <!-- PACKAGES -->
            <section id="packages" class="section">
                <div class="page-header">
                    <h1>Packages</h1>
                    <p>Manage your bundled service packages</p>
                </div>
                <div class="item-list" id="packagesList"></div>
                <button type="button" class="btn btn-outline" onclick="addPackage()" style="margin-top:1rem">+ Add Package</button>
                <button type="button" class="btn btn-save" onclick="savePackages()" style="margin-top:1rem;margin-left:1rem">Save Packages</button>
            </section>

            <!-- TESTIMONIALS -->
            <section id="testimonials" class="section">
                <div class="page-header">
                    <h1>Testimonials</h1>
                    <p>Manage client reviews and testimonials</p>
                </div>
                <div class="item-list" id="testimonialsList"></div>
                <button type="button" class="btn btn-outline" onclick="addTestimonial()" style="margin-top:1rem">+ Add Testimonial</button>
                <button type="button" class="btn btn-save" onclick="saveTestimonials()" style="margin-top:1rem;margin-left:1rem">Save Testimonials</button>
            </section>

            <!-- FAQ -->
            <section id="faq" class="section">
                <div class="page-header">
                    <h1>FAQ</h1>
                    <p>Manage frequently asked questions</p>
                </div>
                <div class="item-list" id="faqList"></div>
                <button type="button" class="btn btn-outline" onclick="addFaq()" style="margin-top:1rem">+ Add Question</button>
                <button type="button" class="btn btn-save" onclick="saveFaq()" style="margin-top:1rem;margin-left:1rem">Save FAQ</button>
            </section>

            <!-- CONTACT -->
            <section id="contact" class="section">
                <div class="page-header">
                    <h1>Contact Information</h1>
                    <p>Update your business contact details</p>
                </div>
                <div class="card">
                    <form id="contactForm">
                        <div class="form-row">
                            <div class="form-group">
                                <label>Business Name</label>
                                <input type="text" id="contactBusiness" placeholder="JLC Studio">
                            </div>
                            <div class="form-group">
                                <label>Tagline</label>
                                <input type="text" id="contactTagline" placeholder="Where Creativity Meets Occasion">
                            </div>
                        </div>
                        <div class="form-row">
                            <div class="form-group">
                                <label>Phone</label>
                                <input type="tel" id="contactPhone" placeholder="(941) 769-7526">
                            </div>
                            <div class="form-group">
                                <label>Email</label>
                                <input type="email" id="contactEmail" placeholder="hello@jlcstudio.art">
                            </div>
                        </div>
                        <div class="form-group">
                            <label>Address</label>
                            <input type="text" id="contactAddress" placeholder="Sarasota, FL 34232">
                        </div>
                        <div class="form-row">
                            <div class="form-group">
                                <label>Instagram URL</label>
                                <input type="url" id="contactInstagram" placeholder="https://instagram.com/jlcstudio">
                            </div>
                            <div class="form-group">
                                <label>Pinterest URL</label>
                                <input type="url" id="contactPinterest" placeholder="https://pinterest.com/jlcstudio">
                            </div>
                        </div>
                        <button type="submit" class="btn btn-save">Save Contact Info</button>
                    </form>
                </div>
            </section>

            <!-- PHOTOS -->
            <section id="photos" class="section">
                <div class="page-header">
                    <h1>Photos</h1>
                    <p>Manage all images across your website. Click any image to replace it.</p>
                </div>

                <div class="card">
                    <div class="card-header">
                        <h3>Hero & Banners</h3>
                    </div>
                    <div class="photo-grid" id="photosHero"></div>
                </div>

                <div class="card">
                    <div class="card-header">
                        <h3>About Section</h3>
                    </div>
                    <div class="photo-grid" id="photosAbout"></div>
                </div>

                <div class="card">
                    <div class="card-header">
                        <h3>Services Images</h3>
                    </div>
                    <div class="photo-grid" id="photosServices"></div>
                </div>

                <div class="card">
                    <div class="card-header">
                        <h3>Homepage Featured</h3>
                    </div>
                    <div class="photo-grid" id="photosFeatured"></div>
                </div>

                <div class="card">
                    <div class="card-header">
                        <h3>Gallery / Portfolio</h3>
                    </div>
                    <div class="photo-grid" id="photosGallery"></div>
                </div>

                <div class="card">
                    <div class="card-header">
                        <h3>Career Timeline</h3>
                    </div>
                    <div class="photo-grid" id="photosTimeline"></div>
                </div>

                <button type="button" class="btn btn-save" onclick="saveImages()">Save All Photos</button>
            </section>

            <!-- THEME -->
            <section id="theme" class="section">
                <div class="page-header">
                    <h1>Color Theme</h1>
                    <p>Full control over all 13 website colors - changes pull from admin.json and apply instantly</p>
                </div>
                <!-- PRESETS -->
                <div class="card">
                    <div class="card-header">
                        <h3>Quick Theme Presets</h3>
                    </div>
                    <div class="color-grid" id="colorPresets"></div>
                    <p style="color:var(--text-light);font-size:0.85rem;margin-top:0.75rem">Click any preset to apply all 13 colors at once</p>
                </div>
                <!-- BRAND COLORS -->
                <div class="card">
                    <div class="card-header">
                        <h3>Brand Colors</h3>
                    </div>
                    <div class="form-row-3">
                        <div class="form-group">
                            <label>Gold (Main Brand)</label>
                            <div class="color-input-group">
                                <input type="color" id="colorGold" value="#C4A052" onchange="updatePreview()">
                                <input type="text" id="colorGoldHex" placeholder="#C4A052" onchange="updatePreview()">
                            </div>
                            <div class="rgb-display" id="colorGoldRgb">RGB: 196, 160, 82</div>
                            <p style="font-size:0.75rem;color:var(--text-light);margin-top:0.5rem">Used on buttons, links, accents</p>
                        </div>
                        <div class="form-group">
                            <label>Gold Light</label>
                            <div class="color-input-group">
                                <input type="color" id="colorGoldLight" value="#D4B872" onchange="updatePreview()">
                                <input type="text" id="colorGoldLightHex" placeholder="#D4B872" onchange="updatePreview()">
                            </div>
                            <div class="rgb-display" id="colorGoldLightRgb">RGB: 212, 184, 114</div>
                            <p style="font-size:0.75rem;color:var(--text-light);margin-top:0.5rem">Light variant accents</p>
                        </div>
                        <div class="form-group">
                            <label>Gold Dark</label>
                            <div class="color-input-group">
                                <input type="color" id="colorGoldDark" value="#A68A42" onchange="updatePreview()">
                                <input type="text" id="colorGoldDarkHex" placeholder="#A68A42" onchange="updatePreview()">
                            </div>
                            <div class="rgb-display" id="colorGoldDarkRgb">RGB: 166, 138, 66</div>
                            <p style="font-size:0.75rem;color:var(--text-light);margin-top:0.5rem">Button hovers</p>
                        </div>
                    </div>
                    <div class="form-row-3">
                        <div class="form-group">
                            <label>Sage (Secondary)</label>
                            <div class="color-input-group">
                                <input type="color" id="colorSage" value="#8B9B7A" onchange="updatePreview()">
                                <input type="text" id="colorSageHex" placeholder="#8B9B7A" onchange="updatePreview()">
                            </div>
                            <div class="rgb-display" id="colorSageRgb">RGB: 139, 155, 122</div>
                            <p style="font-size:0.75rem;color:var(--text-light);margin-top:0.5rem">Secondary brand color</p>
                        </div>
                        <div class="form-group">
                            <label>Sage Light</label>
                            <div class="color-input-group">
                                <input type="color" id="colorSageLight" value="#A5B494" onchange="updatePreview()">
                                <input type="text" id="colorSageLightHex" placeholder="#A5B494" onchange="updatePreview()">
                            </div>
                            <div class="rgb-display" id="colorSageLightRgb">RGB: 165, 180, 148</div>
                            <p style="font-size:0.75rem;color:var(--text-light);margin-top:0.5rem">Light sage variant</p>
                        </div>
                        <div class="form-group">
                            <label>Sage Dark</label>
                            <div class="color-input-group">
                                <input type="color" id="colorSageDark" value="#6B7B5A" onchange="updatePreview()">
                                <input type="text" id="colorSageDarkHex" placeholder="#6B7B5A" onchange="updatePreview()">
                            </div>
                            <div class="rgb-display" id="colorSageDarkRgb">RGB: 107, 123, 90</div>
                            <p style="font-size:0.75rem;color:var(--text-light);margin-top:0.5rem">Dark sage hovers</p>
                        </div>
                    </div>
                </div>
                <!-- BACKGROUNDS -->
                <div class="card">
                    <div class="card-header">
                        <h3>Background & Neutral Colors</h3>
                    </div>
                    <div class="form-row-3">
                        <div class="form-group">
                            <label>White</label>
                            <div class="color-input-group">
                                <input type="color" id="colorWhite" value="#FFFFFF" onchange="updatePreview()">
                                <input type="text" id="colorWhiteHex" placeholder="#FFFFFF" onchange="updatePreview()">
                            </div>
                            <div class="rgb-display" id="colorWhiteRgb">RGB: 255, 255, 255</div>
                        </div>
                        <div class="form-group">
                            <label>Cream (Bg Accent)</label>
                            <div class="color-input-group">
                                <input type="color" id="colorCream" value="#FAF8F5" onchange="updatePreview()">
                                <input type="text" id="colorCreamHex" placeholder="#FAF8F5" onchange="updatePreview()">
                            </div>
                            <div class="rgb-display" id="colorCreamRgb">RGB: 250, 248, 245</div>
                        </div>
                        <div class="form-group">
                            <label>Ivory</label>
                            <div class="color-input-group">
                                <input type="color" id="colorIvory" value="#F5F2ED" onchange="updatePreview()">
                                <input type="text" id="colorIvoryHex" placeholder="#F5F2ED" onchange="updatePreview()">
                            </div>
                            <div class="rgb-display" id="colorIvoryRgb">RGB: 245, 242, 237</div>
                        </div>
                    </div>
                    <div class="form-row-3">
                        <div class="form-group">
                            <label>Taupe (Borders)</label>
                            <div class="color-input-group">
                                <input type="color" id="colorTaupe" value="#E8E4DC" onchange="updatePreview()">
                                <input type="text" id="colorTaupeHex" placeholder="#E8E4DC" onchange="updatePreview()">
                            </div>
                            <div class="rgb-display" id="colorTaupeRgb">RGB: 232, 228, 220</div>
                        </div>
                        <div class="form-group">
                            <label>Warm Gray (Text Light)</label>
                            <div class="color-input-group">
                                <input type="color" id="colorWarmGray" value="#9B9590" onchange="updatePreview()">
                                <input type="text" id="colorWarmGrayHex" placeholder="#9B9590" onchange="updatePreview()">
                            </div>
                            <div class="rgb-display" id="colorWarmGrayRgb">RGB: 155, 149, 144</div>
                        </div>
                        <div class="form-group">
                            <label>White</label>
                            <div class="color-input-group">
                                <input type="color" id="colorWhiteAlt" value="#FFFFFF" onchange="updatePreview()">
                                <input type="text" id="colorWhiteAltHex" placeholder="#FFFFFF" onchange="updatePreview()">
                            </div>
                            <div class="rgb-display" id="colorWhiteAltRgb">RGB: 255, 255, 255</div>
                        </div>
                    </div>
                </div>
                <!-- TEXT COLORS -->
                <div class="card">
                    <div class="card-header">
                        <h3>Text Colors</h3>
                    </div>
                    <div class="form-row-3">
                        <div class="form-group">
                            <label>Charcoal (Body Text)</label>
                            <div class="color-input-group">
                                <input type="color" id="colorCharcoal" value="#3D3D3D" onchange="updatePreview()">
                                <input type="text" id="colorCharcoalHex" placeholder="#3D3D3D" onchange="updatePreview()">
                            </div>
                            <div class="rgb-display" id="colorCharcoalRgb">RGB: 61, 61, 61</div>
                            <p style="font-size:0.75rem;color:var(--text-light);margin-top:0.5rem">Main body text</p>
                        </div>
                        <div class="form-group">
                            <label>Black (Headings)</label>
                            <div class="color-input-group">
                                <input type="color" id="colorBlack" value="#1A1A1A" onchange="updatePreview()">
                                <input type="text" id="colorBlackHex" placeholder="#1A1A1A" onchange="updatePreview()">
                            </div>
                            <div class="rgb-display" id="colorBlackRgb">RGB: 26, 26, 26</div>
                            <p style="font-size:0.75rem;color:var(--text-light);margin-top:0.5rem">Headlines, footer</p>
                        </div>
                    </div>
                </div>
                <!-- LIVE PREVIEW -->
                <div class="card">
                    <div class="card-header">
                        <h3>Live Preview</h3>
                    </div>
                    <div style="background:var(--bg);padding:1.5rem;border-radius:8px;border:1px solid var(--border)">
                        <div style="display:flex;gap:1rem;flex-wrap:wrap;align-items:center">
                            <button style="padding:0.75rem 1.5rem;background:#C4A052;color:white;border:none;border-radius:4px;cursor:pointer;font-weight:500" id="previewBtn">Sample Button</button>
                            <span style="color:#3D3D3D;font-size:1rem">Sample Text</span>
                            <div style="width:40px;height:40px;background:#FAF8F5;border:1px solid #E8E4DC;border-radius:4px"></div>
                            <span style="font-size:0.85rem;color:var(--text-light)">Updates as you change colors</span>
                        </div>
                    </div>
                </div>
                <!-- ACTIONS -->
                <div style="display:flex;gap:1rem;flex-wrap:wrap">
                    <button type="button" class="btn btn-save" onclick="saveTheme()">Save Theme to admin.json</button>
                    <button type="button" class="btn btn-outline" onclick="resetTheme()">Reset to Default</button>
                </div>
            </section>

            <!-- TEAM MEMBERS -->
            <section id="team" class="section">
                <div class="page-header">
                    <h1>Team Members</h1>
                    <p>Manage your team and showcase your creative professionals</p>
                </div>
                <div class="item-list" id="teamList"></div>
                <button type="button" class="btn btn-outline" onclick="addTeamMember()" style="margin-top:1rem">+ Add Team Member</button>
                <button type="button" class="btn btn-save" onclick="saveTeam()" style="margin-top:1rem;margin-left:1rem">Save Team</button>
            </section>

            <!-- AWARDS & CREDENTIALS -->
            <section id="awards" class="section">
                <div class="page-header">
                    <h1>Awards & Press</h1>
                    <p>Manage awards, credentials, and media coverage</p>
                </div>
                <div class="card">
                    <div class="card-header">
                        <h3>Awards & Recognition</h3>
                        <button type="button" class="btn btn-outline btn-small" onclick="addAward()">+ Add Award</button>
                    </div>
                    <div class="item-list" id="awardsList"></div>
                </div>
                <div class="card">
                    <div class="card-header">
                        <h3>Press & Media</h3>
                        <button type="button" class="btn btn-outline btn-small" onclick="addPress()">+ Add Article</button>
                    </div>
                    <div class="item-list" id="pressList"></div>
                </div>
                <button type="button" class="btn btn-save" onclick="saveAwards()" style="margin-top:1rem">Save Awards & Press</button>
            </section>

            <!-- BLOG -->
            <section id="blog" class="section">
                <div class="page-header">
                    <h1>Blog & Articles</h1>
                    <p>Manage your blog posts and articles</p>
                </div>
                <div class="item-list" id="blogList"></div>
                <button type="button" class="btn btn-outline" onclick="addBlogPost()" style="margin-top:1rem">+ Write New Post</button>
                <button type="button" class="btn btn-save" onclick="saveBlog()" style="margin-top:1rem;margin-left:1rem">Save Blog</button>
            </section>

            <!-- CASE STUDIES -->
            <section id="casestudies" class="section">
                <div class="page-header">
                    <h1>Case Studies</h1>
                    <p>Showcase your best work with detailed case studies</p>
                </div>
                <div class="item-list" id="caseStudiesList"></div>
                <button type="button" class="btn btn-outline" onclick="addCaseStudy()" style="margin-top:1rem">+ New Case Study</button>
                <button type="button" class="btn btn-save" onclick="saveCaseStudies()" style="margin-top:1rem;margin-left:1rem">Save Case Studies</button>
            </section>

            <!-- PROMOTIONS -->
            <section id="promotions" class="section">
                <div class="page-header">
                    <h1>Promotions & Discounts</h1>
                    <p>Create and manage special offers and promotions</p>
                </div>
                <div class="item-list" id="promotionsList"></div>
                <button type="button" class="btn btn-outline" onclick="addPromotion()" style="margin-top:1rem">+ New Promotion</button>
                <button type="button" class="btn btn-save" onclick="savePromotions()" style="margin-top:1rem;margin-left:1rem">Save Promotions</button>
            </section>

            <!-- ANALYTICS -->
            <section id="analytics" class="section">
                <div class="page-header">
                    <h1>Business Analytics</h1>
                    <p>View your booking and revenue data from connected services</p>
                </div>
                <div class="stats-grid">
                    <div class="stat-card">
                        <div class="stat-label">Total Bookings</div>
                        <div class="stat-value" id="statBookings">-</div>
                        <div class="stat-note">Via Calendly</div>
                    </div>
                    <div class="stat-card">
                        <div class="stat-label">This Month</div>
                        <div class="stat-value" id="statMonthly">-</div>
                        <div class="stat-note">Upcoming events</div>
                    </div>
                    <div class="stat-card">
                        <div class="stat-label">Revenue</div>
                        <div class="stat-value" id="statRevenue">-</div>
                        <div class="stat-note">Via Stripe</div>
                    </div>
                    <div class="stat-card">
                        <div class="stat-label">Avg. Booking</div>
                        <div class="stat-value" id="statAvg">-</div>
                        <div class="stat-note">Per client</div>
                    </div>
                </div>
                <div class="card">
                    <div class="card-header">
                        <h3>Quick Actions</h3>
                    </div>
                    <div style="display:flex;gap:1rem;flex-wrap:wrap">
                        <a href="https://cal.com/jlynne-huffer-8qatfj" target="_blank" class="btn btn-outline">View Cal.com Schedule</a>
                        <a href="https://dashboard.stripe.com" target="_blank" class="btn btn-outline">View Stripe Dashboard</a>
                    </div>
                    <p style="margin-top:1rem;color:var(--text-light);font-size:0.85rem">Analytics will populate once Cal.com and Stripe integrations are configured. Data shown here is read-only.</p>
                </div>
            </section>

            <!-- INTEGRATIONS -->
            <section id="integrations" class="section">
                <div class="page-header">
                    <h1>Cal.com & Stripe</h1>
                    <p>Manage your booking and payment integrations</p>
                </div>
                <div class="card-grid">
                    <div class="card">
                        <div class="card-header">
                            <h3>Cal.com</h3>
                            <span class="status status-connected">Connected</span>
                        </div>
                        <p style="color:var(--text-light);margin-bottom:1rem;font-size:0.9rem">Manage booking calendar, consultation types, and availability</p>
                        <a href="https://cal.com/jlynne-huffer-8qatfj" target="_blank" class="btn btn-primary">Open Cal.com Dashboard</a>
                    </div>
                    <div class="card">
                        <div class="card-header">
                            <h3>Stripe</h3>
                            <span class="status status-connected">Connected</span>
                        </div>
                        <p style="color:var(--text-light);margin-bottom:1rem;font-size:0.9rem">View payments, transactions, and revenue</p>
                        <a href="https://dashboard.stripe.com" target="_blank" class="btn btn-primary">Open Stripe Dashboard</a>
                    </div>
                </div>
            </section>
        </main>
    </div>

    <div class="toast" id="toast"></div>

    <!-- Photo Upload Modal -->
    <div class="photo-modal" id="photoModal">
        <div class="photo-modal-content">
            <h3 style="margin-bottom:1rem" id="photoModalTitle">Update Photo</h3>
            <img id="photoModalPreview" class="photo-modal-preview" src="" alt="Preview">
            <div class="form-group">
                <label>Image URL</label>
                <input type="text" id="photoModalUrl" placeholder="https://...">
                <div class="form-hint">Paste an image URL or upload to a service like Unsplash, Imgur, or Cloudinary</div>
            </div>
            <div class="form-group">
                <label>Or Upload File</label>
                <input type="file" id="photoModalFile" accept="image/*" style="padding:0.5rem">
                <div class="form-hint">Images will be converted to base64 (best for small images)</div>
            </div>
            <div style="display:flex;gap:1rem;margin-top:1rem">
                <button type="button" class="btn btn-save" onclick="savePhotoUrl()">Save Photo</button>
                <button type="button" class="btn btn-outline" onclick="closePhotoModal()">Cancel</button>
            </div>
        </div>
    </div>

    <!-- Edit Modal (for services/testimonials/faq) -->
    <div class="edit-modal" id="editModal"></div>

    <script>
        // =====================
        // DATA STORE
        // =====================
        let siteData = {
            hero: {},
            about: {},
            settings: {},
            services: [],
            packages: [],
            testimonials: [],
            faq: [],
            theme: {},
            images: {}
        };
        let currentEditingPhoto = null;

        // =====================
        // AUTH
        // =====================
        const CREDS = { username: 'jlcstudio', password: 'JLC2024!' };
        let authToken = null;

        document.getElementById('loginForm').addEventListener('submit', function(e) {
            e.preventDefault();
            const u = document.getElementById('username').value;
            const p = document.getElementById('password').value;
            if (u === CREDS.username && p === CREDS.password) {
                authToken = 'admin_' + Date.now();
                localStorage.setItem('jlc_token', authToken);
                showDashboard();
            } else {
                document.getElementById('loginError').textContent = 'Invalid username or password';
                document.getElementById('loginError').classList.add('show');
            }
        });

        function checkAuth() {
            const token = localStorage.getItem('jlc_token');
            if (token) {
                authToken = token;
                showDashboard();
            }
        }

        function showDashboard() {
            document.getElementById('loginScreen').classList.add('hidden');
            document.getElementById('dashboard').classList.add('active');
            loadAllData();
        }

        function logout() {
            localStorage.removeItem('jlc_token');
            location.reload();
        }

        // =====================
        // NAVIGATION
        // =====================
        document.querySelectorAll('.nav-item').forEach(item => {
            item.addEventListener('click', function() {
                const section = this.dataset.section;
                document.querySelectorAll('.nav-item').forEach(n => n.classList.remove('active'));
                this.classList.add('active');
                document.querySelectorAll('.section').forEach(s => s.classList.remove('active'));
                document.getElementById(section).classList.add('active');
            });
        });

        // =====================
        // LOAD DATA
        // =====================
        async function loadAllData() {
            // Load single master admin.json file
            const adminData = await fetchJSON('admin');

            if (adminData) {
                siteData = adminData;
            }

            populateAllForms();
        }

        async function fetchJSON(name) {
            try {
                const res = await fetch(`/_data/${name}.json?t=${Date.now()}`);
                return res.ok ? await res.json() : null;
            } catch { return null; }
        }

        // =====================
        // POPULATE FORMS
        // =====================
        function populateAllForms() {
            // Hero
            document.getElementById('heroBadge').value = siteData.hero.badge || '';
            document.getElementById('heroTitle1').value = siteData.hero.titleLine1 || '';
            document.getElementById('heroTitle2').value = siteData.hero.titleLine2 || '';
            document.getElementById('heroSubtitle').value = siteData.hero.subtitle || '';
            document.getElementById('heroDesc').value = siteData.hero.description || '';
            document.getElementById('heroBtnPrimary').value = siteData.hero.primaryBtn || '';
            document.getElementById('heroBtnSecondary').value = siteData.hero.secondaryBtn || '';
            document.getElementById('heroImage').value = siteData.hero.heroImage || '';

            // About
            document.getElementById('aboutName').value = siteData.about.name || '';
            document.getElementById('aboutTitle').value = siteData.about.title || '';
            document.getElementById('aboutBio').value = siteData.about.bio || '';
            document.getElementById('aboutYears').value = siteData.about.years || '';
            document.getElementById('aboutEvents').value = siteData.about.events || '';
            document.getElementById('aboutPhoto').value = siteData.about.photo || '';

            // Contact/Settings
            document.getElementById('contactBusiness').value = siteData.settings.businessName || '';
            document.getElementById('contactTagline').value = siteData.settings.tagline || '';
            document.getElementById('contactPhone').value = siteData.settings.phone || '';
            document.getElementById('contactEmail').value = siteData.settings.email || '';
            document.getElementById('contactAddress').value = siteData.settings.address || '';
            document.getElementById('contactInstagram').value = siteData.settings.instagram || '';
            document.getElementById('contactPinterest').value = siteData.settings.pinterest || '';

            // Render lists
            renderServices();
            renderPackages();
            renderTestimonials();
            renderFaq();
            renderTheme();
            renderPhotos();
            initPreview();
        }

        // =====================
        // PREVIEW MODE
        // =====================
        let previewChanges = {};
        let hasUnsavedChanges = false;

        // Preview tab switching
        document.querySelectorAll('.preview-tab').forEach(tab => {
            tab.addEventListener('click', function() {
                document.querySelectorAll('.preview-tab').forEach(t => t.classList.remove('active'));
                document.querySelectorAll('.preview-page').forEach(p => p.classList.remove('active'));
                this.classList.add('active');
                document.getElementById('preview-' + this.dataset.page).classList.add('active');
            });
        });

        function initPreview() {
            renderHomepagePreview();
            renderServicesPreview();
            renderContactPreview();
        }

        function renderHomepagePreview() {
            const hero = siteData.hero || {};
            const about = siteData.about || {};
            const testimonials = siteData.testimonials || [];

            const container = document.getElementById('preview-home');
            container.innerHTML = `
                <!-- Hero Preview -->
                <div class="preview-section">
                    <div class="preview-section-header">
                        <h3>Hero Banner</h3>
                    </div>
                    <div class="preview-hero-mock">
                        <div class="editable-wrapper">
                            <div class="preview-hero-badge editable-text" contenteditable="true" data-field="hero.badge">${hero.badge || 'Badge Text'}</div>
                            <button class="edit-btn" onclick="focusEditable(this)" title="Edit"></button>
                        </div>

                        <div class="preview-hero-title">
                            <div class="editable-wrapper" style="display:block">
                                <span class="editable-text" contenteditable="true" data-field="hero.titleLine1">${hero.titleLine1 || 'Title Line 1'}</span>
                                <button class="edit-btn" onclick="focusEditable(this)" title="Edit"></button>
                            </div>
                            <div class="editable-wrapper" style="display:block">
                                <span class="line2 editable-text" contenteditable="true" data-field="hero.titleLine2">${hero.titleLine2 || 'Title Line 2'}</span>
                                <button class="edit-btn" onclick="focusEditable(this)" title="Edit"></button>
                            </div>
                        </div>

                        <div class="editable-wrapper" style="display:block">
                            <div class="preview-hero-subtitle editable-text" contenteditable="true" data-field="hero.subtitle">${hero.subtitle || 'Subtitle'}</div>
                            <button class="edit-btn" onclick="focusEditable(this)" title="Edit"></button>
                        </div>

                        <div class="editable-wrapper" style="display:block">
                            <div class="preview-hero-description editable-text" contenteditable="true" data-field="hero.description">${hero.description || 'Description text'}</div>
                            <button class="edit-btn" onclick="focusEditable(this)" title="Edit"></button>
                        </div>

                        <div class="preview-hero-buttons">
                            <div class="editable-wrapper">
                                <span class="preview-btn-primary editable-text" contenteditable="true" data-field="hero.primaryBtn">${hero.primaryBtn || 'Primary Button'}</span>
                                <button class="edit-btn" onclick="focusEditable(this)" title="Edit"></button>
                            </div>
                            <div class="editable-wrapper">
                                <span class="preview-btn-outline editable-text" contenteditable="true" data-field="hero.secondaryBtn">${hero.secondaryBtn || 'Secondary Button'}</span>
                                <button class="edit-btn" onclick="focusEditable(this)" title="Edit"></button>
                            </div>
                        </div>
                    </div>
                </div>

                <!-- About Preview -->
                <div class="preview-section">
                    <div class="preview-section-header">
                        <h3>About Section</h3>
                    </div>
                    <div class="preview-about-mock">
                        <div style="display:flex;gap:1.5rem;align-items:flex-start;flex-wrap:wrap">
                            <div style="flex:0 0 100px">
                                <div style="width:100px;height:120px;background:#e5e5e5;border-radius:8px;display:flex;align-items:center;justify-content:center;color:#999;font-size:0.7rem">Photo</div>
                            </div>
                            <div style="flex:1;min-width:200px">
                                <div class="editable-wrapper" style="display:block">
                                    <h4 class="editable-text" contenteditable="true" data-field="about.name" style="font-size:1.25rem;margin-bottom:0.25rem">${about.name || 'Name'}</h4>
                                    <button class="edit-btn" onclick="focusEditable(this)" title="Edit"></button>
                                </div>
                                <div class="editable-wrapper" style="display:block">
                                    <p class="editable-text" contenteditable="true" data-field="about.title" style="color:#C4A052;margin-bottom:0.75rem;font-size:0.85rem">${about.title || 'Title'}</p>
                                    <button class="edit-btn" onclick="focusEditable(this)" title="Edit"></button>
                                </div>
                                <div class="editable-wrapper" style="display:block">
                                    <p class="editable-text" contenteditable="true" data-field="about.bio" style="font-size:0.8rem;line-height:1.5;color:#666">${about.bio || 'Bio text...'}</p>
                                    <button class="edit-btn" onclick="focusEditable(this)" title="Edit"></button>
                                </div>
                                <div style="display:flex;gap:1.5rem;margin-top:0.75rem">
                                    <div style="text-align:center">
                                        <div class="editable-wrapper">
                                            <span class="editable-text" contenteditable="true" data-field="about.years" style="font-size:1.25rem;font-weight:600;color:#C4A052">${about.years || 15}</span>
                                            <button class="edit-btn" onclick="focusEditable(this)" title="Edit"></button>
                                        </div>
                                        <div style="font-size:0.65rem;color:#666">Years</div>
                                    </div>
                                    <div style="text-align:center">
                                        <div class="editable-wrapper">
                                            <span class="editable-text" contenteditable="true" data-field="about.events" style="font-size:1.25rem;font-weight:600;color:#C4A052">${about.events || 500}</span>
                                            <button class="edit-btn" onclick="focusEditable(this)" title="Edit"></button>
                                        </div>
                                        <div style="font-size:0.65rem;color:#666">Events</div>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>

                <!-- Testimonials Preview -->
                <div class="preview-section">
                    <div class="preview-section-header">
                        <h3>Testimonials</h3>
                        <button class="btn btn-small btn-outline" onclick="openTestimonialModal(-1)">+ Add</button>
                    </div>
                    <div class="preview-testimonials">
                        ${renderPreviewTestimonials(testimonials)}
                    </div>
                </div>
            `;

            attachEditableListeners();
        }

        function renderPreviewTestimonials(testimonials) {
            if (!testimonials.length) return '<p style="color:#666">No testimonials yet. Click "+ Add" to add one.</p>';
            return testimonials.map((t, i) => `
                <div class="preview-testimonial-card">
                    <div style="display:flex;justify-content:flex-end;margin-bottom:0.5rem">
                        <button class="edit-btn" style="position:static;opacity:1" onclick="openTestimonialModal(${i})" title="Edit"></button>
                    </div>
                    <div class="preview-testimonial-quote">"${t.quote || ''}"</div>
                    <div class="preview-testimonial-author">
                        <div class="preview-author-avatar">${t.initials || ''}</div>
                        <div>
                            <div class="preview-author-name">${t.name || ''}</div>
                            <div class="preview-author-event">${t.event || ''}</div>
                        </div>
                    </div>
                </div>
            `).join('');
        }

        function renderServicesPreview() {
            const services = siteData.services || [];
            const packages = siteData.packages || [];

            const container = document.getElementById('preview-services');
            container.innerHTML = `
                <!-- Services by Category -->
                <div class="preview-section">
                    <div class="preview-section-header">
                        <h3>Floral Design</h3>
                        <button class="btn btn-small btn-outline" onclick="openServiceModal(-1, 'floral')">+ Add</button>
                    </div>
                    <div class="preview-services-grid">
                        ${renderPreviewServiceCards(services.filter(s => s.category === 'floral'), 'floral')}
                    </div>
                </div>

                <div class="preview-section">
                    <div class="preview-section-header">
                        <h3>Event Decor</h3>
                        <button class="btn btn-small btn-outline" onclick="openServiceModal(-1, 'decor')">+ Add</button>
                    </div>
                    <div class="preview-services-grid">
                        ${renderPreviewServiceCards(services.filter(s => s.category === 'decor'), 'decor')}
                    </div>
                </div>

                <div class="preview-section">
                    <div class="preview-section-header">
                        <h3>Custom Tailoring</h3>
                        <button class="btn btn-small btn-outline" onclick="openServiceModal(-1, 'tailoring')">+ Add</button>
                    </div>
                    <div class="preview-services-grid">
                        ${renderPreviewServiceCards(services.filter(s => s.category === 'tailoring'), 'tailoring')}
                    </div>
                </div>

                <!-- Packages -->
                <div class="preview-section">
                    <div class="preview-section-header">
                        <h3>Packages</h3>
                        <button class="btn btn-small btn-outline" onclick="openPackageModal(-1)">+ Add</button>
                    </div>
                    <div class="preview-services-grid">
                        ${renderPreviewPackages(packages)}
                    </div>
                </div>
            `;
        }

        function renderPreviewServiceCards(services, category) {
            if (!services.length) return '<p style="color:#666;grid-column:1/-1">No services yet</p>';
            return services.map((s, i) => {
                const globalIndex = siteData.services.indexOf(s);
                return `
                    <div class="preview-service-card">
                        <h4>${s.type || 'Service Name'}<button class="edit-btn" style="position:static;opacity:1;margin-left:auto" onclick="openServiceModal(${globalIndex}, '${category}')" title="Edit"></button></h4>
                        <p>${s.desc || 'Description'}</p>
                        <span class="price">${s.price || 'Price'}</span>
                    </div>
                `;
            }).join('');
        }

        function renderPreviewPackages(packages) {
            if (!packages.length) return '<p style="color:#666;grid-column:1/-1">No packages yet</p>';
            return packages.map((p, i) => `
                <div class="preview-service-card" style="${p.featured ? 'border-color:#C4A052;border-width:2px' : ''}">
                    <h4>${p.title || 'Package'} ${p.featured ? '<span style="font-size:0.6rem;background:#C4A052;color:white;padding:2px 6px;border-radius:10px;margin-left:0.5rem">Popular</span>' : ''}<button class="edit-btn" style="position:static;opacity:1;margin-left:auto" onclick="openPackageModal(${i})" title="Edit"></button></h4>
                    <p>${p.description || ''}</p>
                    <span class="price">${p.price || ''}</span>
                </div>
            `).join('');
        }

        function renderContactPreview() {
            const settings = siteData.settings || {};
            const faq = siteData.faq || [];

            const container = document.getElementById('preview-contact');
            container.innerHTML = `
                <!-- Contact Info -->
                <div class="preview-section">
                    <div class="preview-section-header">
                        <h3>Contact Information</h3>
                    </div>
                    <div class="preview-contact-grid">
                        <div class="preview-contact-item">
                            <div class="preview-contact-label">Business Name</div>
                            <div class="editable-wrapper" style="display:block">
                                <div class="preview-contact-value editable-text" contenteditable="true" data-field="settings.businessName">${settings.businessName || 'Business Name'}</div>
                                <button class="edit-btn" onclick="focusEditable(this)" title="Edit"></button>
                            </div>
                        </div>
                        <div class="preview-contact-item">
                            <div class="preview-contact-label">Phone</div>
                            <div class="editable-wrapper" style="display:block">
                                <div class="preview-contact-value editable-text" contenteditable="true" data-field="settings.phone">${settings.phone || 'Phone'}</div>
                                <button class="edit-btn" onclick="focusEditable(this)" title="Edit"></button>
                            </div>
                        </div>
                        <div class="preview-contact-item">
                            <div class="preview-contact-label">Email</div>
                            <div class="editable-wrapper" style="display:block">
                                <div class="preview-contact-value editable-text" contenteditable="true" data-field="settings.email">${settings.email || 'Email'}</div>
                                <button class="edit-btn" onclick="focusEditable(this)" title="Edit"></button>
                            </div>
                        </div>
                        <div class="preview-contact-item">
                            <div class="preview-contact-label">Address</div>
                            <div class="editable-wrapper" style="display:block">
                                <div class="preview-contact-value editable-text" contenteditable="true" data-field="settings.address">${settings.address || 'Address'}</div>
                                <button class="edit-btn" onclick="focusEditable(this)" title="Edit"></button>
                            </div>
                        </div>
                    </div>
                </div>

                <!-- FAQ -->
                <div class="preview-section">
                    <div class="preview-section-header">
                        <h3>Frequently Asked Questions</h3>
                        <button class="btn btn-small btn-outline" onclick="openFaqModal(-1)">+ Add</button>
                    </div>
                    <div class="preview-faq-list">
                        ${renderPreviewFaq(faq)}
                    </div>
                </div>
            `;

            attachEditableListeners();
        }

        function renderPreviewFaq(faq) {
            if (!faq.length) return '<p style="color:#666">No FAQ items yet. Click "+ Add" to add one.</p>';
            return faq.map((f, i) => `
                <div class="preview-faq-item">
                    <div class="preview-faq-question">
                        <span>Q: ${f.question || ''}</span>
                        <button class="edit-btn" style="position:static;opacity:1" onclick="openFaqModal(${i})" title="Edit"></button>
                    </div>
                    <div class="preview-faq-answer">A: ${f.answer || ''}</div>
                </div>
            `).join('');
        }

        // Focus editable element
        function focusEditable(button) {
            const wrapper = button.parentElement;
            const editable = wrapper.querySelector('.editable-text');
            if (editable) {
                editable.focus();
                const range = document.createRange();
                range.selectNodeContents(editable);
                const sel = window.getSelection();
                sel.removeAllRanges();
                sel.addRange(range);
            }
        }

        // Attach input listeners for change tracking
        function attachEditableListeners() {
            document.querySelectorAll('.editable-text').forEach(el => {
                el.addEventListener('input', function() {
                    const field = this.dataset.field;
                    const value = this.textContent.trim();
                    previewChanges[field] = value;
                    this.classList.add('modified');
                    markUnsavedChanges();
                });

                el.addEventListener('blur', function() {
                    const field = this.dataset.field;
                    const value = this.textContent.trim();
                    updateSiteDataField(field, value);
                });
            });
        }

        // Update nested siteData field
        function updateSiteDataField(path, value) {
            const parts = path.split('.');
            let obj = siteData;
            for (let i = 0; i < parts.length - 1; i++) {
                if (!obj[parts[i]]) obj[parts[i]] = {};
                obj = obj[parts[i]];
            }
            // Handle numeric values for years/events
            if (parts[parts.length - 1] === 'years' || parts[parts.length - 1] === 'events') {
                obj[parts[parts.length - 1]] = parseInt(value) || 0;
            } else {
                obj[parts[parts.length - 1]] = value;
            }
        }

        // Show unsaved indicator
        function markUnsavedChanges() {
            hasUnsavedChanges = true;
            document.getElementById('previewSaveBar').style.display = 'flex';
        }

        // Save all preview changes
        async function saveAllPreviewChanges() {
            if (!hasUnsavedChanges && Object.keys(previewChanges).length === 0) {
                showToast('No changes to save', '');
                return;
            }

            const saveBtn = document.querySelector('#previewSaveBar .btn-save');
            saveBtn.textContent = 'Saving...';
            saveBtn.disabled = true;

            try {
                // Determine which files need saving
                const filesToSave = new Set();
                Object.keys(previewChanges).forEach(key => {
                    const fileType = key.split('.')[0];
                    filesToSave.add(fileType);
                });

                // Save each modified file
                for (const fileType of filesToSave) {
                    await saveToGitHub(fileType, siteData[fileType]);
                }

                // Reset state
                previewChanges = {};
                hasUnsavedChanges = false;
                document.getElementById('previewSaveBar').style.display = 'none';
                document.querySelectorAll('.editable-text.modified').forEach(el => {
                    el.classList.remove('modified');
                });

                showToast('All changes saved!', 'success');

                // Re-populate forms to keep in sync
                populateAllForms();
            } catch (error) {
                showToast('Error saving: ' + error.message, 'error');
            } finally {
                saveBtn.textContent = 'Save All Changes';
                saveBtn.disabled = false;
            }
        }

        // Modal for editing testimonials
        function openTestimonialModal(index) {
            const isNew = index === -1;
            const t = isNew ? { name: '', event: '', quote: '', initials: '', order: siteData.testimonials.length + 1 } : siteData.testimonials[index];

            const modal = document.getElementById('editModal');
            modal.innerHTML = `
                <div class="edit-modal-content">
                    <div class="edit-modal-header">
                        <h3>\${isNew ? 'Add Testimonial' : 'Edit Testimonial'}</h3>
                        <button class="edit-modal-close" onclick="closeEditModal()">&times;</button>
                    </div>
                    <div class="form-row">
                        <div class="form-group">
                            <label>Client Name</label>
                            <input type="text" id="modal-t-name" value="\${t.name || ''}">
                        </div>
                        <div class="form-group">
                            <label>Initials</label>
                            <input type="text" id="modal-t-initials" value="\${t.initials || ''}" maxlength="4" style="width:80px">
                        </div>
                    </div>
                    <div class="form-group">
                        <label>Event/Role</label>
                        <input type="text" id="modal-t-event" value="\${t.event || ''}">
                    </div>
                    <div class="form-group">
                        <label>Quote</label>
                        <textarea id="modal-t-quote" rows="4">\${t.quote || ''}</textarea>
                    </div>
                    <div class="edit-modal-actions">
                        <button class="btn btn-save" onclick="saveTestimonialFromModal(\${index})">\${isNew ? 'Add' : 'Save'}</button>
                        \${!isNew ? '<button class="btn btn-danger" onclick="deleteTestimonialFromModal(' + index + ')">Delete</button>' : ''}
                        <button class="btn btn-outline" onclick="closeEditModal()">Cancel</button>
                    </div>
                </div>
            `;
            modal.classList.add('show');
        }

        function saveTestimonialFromModal(index) {
            const isNew = index === -1;
            const testimonial = {
                name: document.getElementById('modal-t-name').value,
                initials: document.getElementById('modal-t-initials').value,
                event: document.getElementById('modal-t-event').value,
                quote: document.getElementById('modal-t-quote').value,
                order: isNew ? siteData.testimonials.length + 1 : siteData.testimonials[index].order
            };

            if (isNew) {
                siteData.testimonials.push(testimonial);
            } else {
                siteData.testimonials[index] = testimonial;
            }

            previewChanges['testimonials'] = true;
            markUnsavedChanges();
            closeEditModal();
            renderHomepagePreview();
            renderTestimonials(); // Update form section too
        }

        function deleteTestimonialFromModal(index) {
            if (confirm('Delete this testimonial?')) {
                siteData.testimonials.splice(index, 1);
                previewChanges['testimonials'] = true;
                markUnsavedChanges();
                closeEditModal();
                renderHomepagePreview();
                renderTestimonials();
            }
        }

        // Modal for editing services
        function openServiceModal(index, category = 'floral') {
            const isNew = index === -1;
            const s = isNew ? { category: category, type: '', desc: '', price: '' } : siteData.services[index];

            const modal = document.getElementById('editModal');
            modal.innerHTML = `
                <div class="edit-modal-content">
                    <div class="edit-modal-header">
                        <h3>\${isNew ? 'Add Service' : 'Edit Service'}</h3>
                        <button class="edit-modal-close" onclick="closeEditModal()">&times;</button>
                    </div>
                    <div class="form-group">
                        <label>Category</label>
                        <select id="modal-s-category">
                            <option value="floral" \${s.category === 'floral' ? 'selected' : ''}>Floral Design</option>
                            <option value="decor" \${s.category === 'decor' ? 'selected' : ''}>Event Decor</option>
                            <option value="tailoring" \${s.category === 'tailoring' ? 'selected' : ''}>Custom Tailoring</option>
                        </select>
                    </div>
                    <div class="form-group">
                        <label>Service Name</label>
                        <input type="text" id="modal-s-type" value="\${s.type || ''}">
                    </div>
                    <div class="form-group">
                        <label>Description</label>
                        <input type="text" id="modal-s-desc" value="\${s.desc || ''}">
                    </div>
                    <div class="form-group">
                        <label>Price Range</label>
                        <input type="text" id="modal-s-price" value="\${s.price || ''}">
                    </div>
                    <div class="edit-modal-actions">
                        <button class="btn btn-save" onclick="saveServiceFromModal(\${index})">\${isNew ? 'Add' : 'Save'}</button>
                        \${!isNew ? '<button class="btn btn-danger" onclick="deleteServiceFromModal(' + index + ')">Delete</button>' : ''}
                        <button class="btn btn-outline" onclick="closeEditModal()">Cancel</button>
                    </div>
                </div>
            `;
            modal.classList.add('show');
        }

        function saveServiceFromModal(index) {
            const isNew = index === -1;
            const service = {
                category: document.getElementById('modal-s-category').value,
                type: document.getElementById('modal-s-type').value,
                desc: document.getElementById('modal-s-desc').value,
                price: document.getElementById('modal-s-price').value
            };

            if (isNew) {
                siteData.services.push(service);
            } else {
                siteData.services[index] = service;
            }

            previewChanges['services'] = true;
            markUnsavedChanges();
            closeEditModal();
            renderServicesPreview();
            renderServices(); // Update form section too
        }

        function deleteServiceFromModal(index) {
            if (confirm('Delete this service?')) {
                siteData.services.splice(index, 1);
                previewChanges['services'] = true;
                markUnsavedChanges();
                closeEditModal();
                renderServicesPreview();
                renderServices();
            }
        }

        // Modal for editing packages
        function openPackageModal(index) {
            const isNew = index === -1;
            const p = isNew ? { title: '', description: '', price: '', featured: false, includes: [], order: siteData.packages.length + 1 } : siteData.packages[index];

            const modal = document.getElementById('editModal');
            modal.innerHTML = `
                <div class="edit-modal-content">
                    <div class="edit-modal-header">
                        <h3>\${isNew ? 'Add Package' : 'Edit Package'}</h3>
                        <button class="edit-modal-close" onclick="closeEditModal()">&times;</button>
                    </div>
                    <div class="form-row">
                        <div class="form-group">
                            <label>Package Title</label>
                            <input type="text" id="modal-p-title" value="\${p.title || ''}">
                        </div>
                        <div class="form-group">
                            <label>Price</label>
                            <input type="text" id="modal-p-price" value="\${p.price || ''}">
                        </div>
                    </div>
                    <div class="form-group">
                        <label>Description</label>
                        <textarea id="modal-p-desc" rows="2">\${p.description || ''}</textarea>
                    </div>
                    <div class="form-group">
                        <label>Featured (Most Popular)</label>
                        <select id="modal-p-featured">
                            <option value="false" \${!p.featured ? 'selected' : ''}>No</option>
                            <option value="true" \${p.featured ? 'selected' : ''}>Yes</option>
                        </select>
                    </div>
                    <div class="form-group">
                        <label>Includes (comma separated)</label>
                        <textarea id="modal-p-includes" rows="2">\${(p.includes || []).join(', ')}</textarea>
                    </div>
                    <div class="edit-modal-actions">
                        <button class="btn btn-save" onclick="savePackageFromModal(\${index})">\${isNew ? 'Add' : 'Save'}</button>
                        \${!isNew ? '<button class="btn btn-danger" onclick="deletePackageFromModal(' + index + ')">Delete</button>' : ''}
                        <button class="btn btn-outline" onclick="closeEditModal()">Cancel</button>
                    </div>
                </div>
            `;
            modal.classList.add('show');
        }

        function savePackageFromModal(index) {
            const isNew = index === -1;
            const pkg = {
                title: document.getElementById('modal-p-title').value,
                description: document.getElementById('modal-p-desc').value,
                price: document.getElementById('modal-p-price').value,
                featured: document.getElementById('modal-p-featured').value === 'true',
                includes: document.getElementById('modal-p-includes').value.split(',').map(s => s.trim()).filter(Boolean),
                order: isNew ? siteData.packages.length + 1 : siteData.packages[index].order
            };

            if (isNew) {
                siteData.packages.push(pkg);
            } else {
                siteData.packages[index] = pkg;
            }

            previewChanges['packages'] = true;
            markUnsavedChanges();
            closeEditModal();
            renderServicesPreview();
            renderPackages(); // Update form section too
        }

        function deletePackageFromModal(index) {
            if (confirm('Delete this package?')) {
                siteData.packages.splice(index, 1);
                previewChanges['packages'] = true;
                markUnsavedChanges();
                closeEditModal();
                renderServicesPreview();
                renderPackages();
            }
        }

        // Modal for editing FAQ
        function openFaqModal(index) {
            const isNew = index === -1;
            const f = isNew ? { question: '', answer: '', order: siteData.faq.length + 1 } : siteData.faq[index];

            const modal = document.getElementById('editModal');
            modal.innerHTML = `
                <div class="edit-modal-content">
                    <div class="edit-modal-header">
                        <h3>\${isNew ? 'Add FAQ' : 'Edit FAQ'}</h3>
                        <button class="edit-modal-close" onclick="closeEditModal()">&times;</button>
                    </div>
                    <div class="form-group">
                        <label>Question</label>
                        <input type="text" id="modal-f-question" value="\${f.question || ''}">
                    </div>
                    <div class="form-group">
                        <label>Answer</label>
                        <textarea id="modal-f-answer" rows="4">\${f.answer || ''}</textarea>
                    </div>
                    <div class="edit-modal-actions">
                        <button class="btn btn-save" onclick="saveFaqFromModal(\${index})">\${isNew ? 'Add' : 'Save'}</button>
                        \${!isNew ? '<button class="btn btn-danger" onclick="deleteFaqFromModal(' + index + ')">Delete</button>' : ''}
                        <button class="btn btn-outline" onclick="closeEditModal()">Cancel</button>
                    </div>
                </div>
            `;
            modal.classList.add('show');
        }

        function saveFaqFromModal(index) {
            const isNew = index === -1;
            const faqItem = {
                question: document.getElementById('modal-f-question').value,
                answer: document.getElementById('modal-f-answer').value,
                order: isNew ? siteData.faq.length + 1 : siteData.faq[index].order
            };

            if (isNew) {
                siteData.faq.push(faqItem);
            } else {
                siteData.faq[index] = faqItem;
            }

            previewChanges['faq'] = true;
            markUnsavedChanges();
            closeEditModal();
            renderContactPreview();
            renderFaq(); // Update form section too
        }

        function deleteFaqFromModal(index) {
            if (confirm('Delete this FAQ?')) {
                siteData.faq.splice(index, 1);
                previewChanges['faq'] = true;
                markUnsavedChanges();
                closeEditModal();
                renderContactPreview();
                renderFaq();
            }
        }

        function closeEditModal() {
            document.getElementById('editModal').classList.remove('show');
        }

        // Close modal on outside click
        document.getElementById('editModal').addEventListener('click', function(e) {
            if (e.target === this) closeEditModal();
        });

        // =====================
        // SERVICES
        // =====================
        function renderServices() {
            ['floral', 'decor', 'tailoring'].forEach(cat => {
                const container = document.getElementById(cat + 'Services');
                const items = (siteData.services || []).filter(s => s.category === cat);
                container.innerHTML = items.length ? items.map((item, i) => `
                    <div class="item">
                        <div class="item-header">
                            <span class="item-number">${cat} Service ${i + 1}</span>
                            <button class="delete-btn" onclick="deleteService('${cat}', ${i})">Remove</button>
                        </div>
                        <div class="form-row">
                            <div class="form-group">
                                <label>Service Name</label>
                                <input type="text" value="${item.type || ''}" onchange="updateService('${cat}', ${i}, 'type', this.value)">
                            </div>
                            <div class="form-group">
                                <label>Price Range</label>
                                <input type="text" value="${item.price || ''}" onchange="updateService('${cat}', ${i}, 'price', this.value)">
                            </div>
                        </div>
                        <div class="form-group">
                            <label>Description</label>
                            <input type="text" value="${item.desc || ''}" onchange="updateService('${cat}', ${i}, 'desc', this.value)">
                        </div>
                    </div>
                `).join('') : '<p style="color:var(--text-light);padding:1rem">No services yet. Click "+ Add Service" to add one.</p>';
            });
        }

        function updateService(category, index, field, value) {
            const catServices = siteData.services.filter(s => s.category === category);
            const actualIndex = siteData.services.indexOf(catServices[index]);
            if (actualIndex >= 0) siteData.services[actualIndex][field] = value;
        }

        function addService(category) {
            siteData.services.push({ category, type: '', desc: '', price: '' });
            renderServices();
        }

        function deleteService(category, index) {
            const catServices = siteData.services.filter(s => s.category === category);
            const actualIndex = siteData.services.indexOf(catServices[index]);
            if (actualIndex >= 0) siteData.services.splice(actualIndex, 1);
            renderServices();
        }

        async function saveServices() {
            await saveToGitHub('services', siteData.services);
        }

        // =====================
        // PACKAGES
        // =====================
        function renderPackages() {
            const container = document.getElementById('packagesList');
            const items = siteData.packages || [];
            container.innerHTML = items.length ? items.map((pkg, i) => `
                <div class="item card">
                    <div class="item-header">
                        <span class="item-number">Package ${i + 1}</span>
                        <button class="delete-btn" onclick="deletePackage(${i})">Remove</button>
                    </div>
                    <div class="form-row">
                        <div class="form-group">
                            <label>Package Title</label>
                            <input type="text" value="${pkg.title || ''}" onchange="siteData.packages[${i}].title = this.value">
                        </div>
                        <div class="form-group">
                            <label>Price</label>
                            <input type="text" value="${pkg.price || ''}" onchange="siteData.packages[${i}].price = this.value">
                        </div>
                    </div>
                    <div class="form-group">
                        <label>Description</label>
                        <textarea rows="2" onchange="siteData.packages[${i}].description = this.value">${pkg.description || ''}</textarea>
                    </div>
                    <div class="form-group">
                        <label>Featured</label>
                        <select onchange="siteData.packages[${i}].featured = this.value === 'true'">
                            <option value="false" ${!pkg.featured ? 'selected' : ''}>No</option>
                            <option value="true" ${pkg.featured ? 'selected' : ''}>Yes (Highlighted)</option>
                        </select>
                    </div>
                    <div class="form-group">
                        <label>Includes (comma separated)</label>
                        <textarea rows="2" onchange="siteData.packages[${i}].includes = this.value.split(',').map(s=>s.trim())">${(pkg.includes || []).join(', ')}</textarea>
                    </div>
                </div>
            `).join('') : '<p style="color:var(--text-light);padding:1rem">No packages yet.</p>';
        }

        function addPackage() {
            siteData.packages.push({ title: '', description: '', price: '', featured: false, includes: [], order: siteData.packages.length + 1 });
            renderPackages();
        }

        function deletePackage(index) {
            siteData.packages.splice(index, 1);
            renderPackages();
        }

        async function savePackages() {
            await saveToGitHub('packages', siteData.packages);
        }

        // =====================
        // TESTIMONIALS
        // =====================
        function renderTestimonials() {
            const container = document.getElementById('testimonialsList');
            const items = siteData.testimonials || [];
            container.innerHTML = items.length ? items.map((t, i) => `
                <div class="item card">
                    <div class="item-header">
                        <span class="item-number">Testimonial ${i + 1}</span>
                        <button class="delete-btn" onclick="deleteTestimonial(${i})">Remove</button>
                    </div>
                    <div class="form-row">
                        <div class="form-group">
                            <label>Client Name</label>
                            <input type="text" value="${t.name || ''}" onchange="siteData.testimonials[${i}].name = this.value">
                        </div>
                        <div class="form-group">
                            <label>Event/Role</label>
                            <input type="text" value="${t.event || ''}" onchange="siteData.testimonials[${i}].event = this.value">
                        </div>
                    </div>
                    <div class="form-group">
                        <label>Quote</label>
                        <textarea rows="3" onchange="siteData.testimonials[${i}].quote = this.value">${t.quote || ''}</textarea>
                    </div>
                    <div class="form-group">
                        <label>Initials (for avatar)</label>
                        <input type="text" value="${t.initials || ''}" onchange="siteData.testimonials[${i}].initials = this.value" maxlength="4" style="width:100px">
                    </div>
                </div>
            `).join('') : '<p style="color:var(--text-light);padding:1rem">No testimonials yet.</p>';
        }

        function addTestimonial() {
            siteData.testimonials.push({ name: '', event: '', quote: '', initials: '', order: siteData.testimonials.length + 1 });
            renderTestimonials();
        }

        function deleteTestimonial(index) {
            siteData.testimonials.splice(index, 1);
            renderTestimonials();
        }

        async function saveTestimonials() {
            await saveToGitHub('testimonials', siteData.testimonials);
        }

        // =====================
        // FAQ
        // =====================
        function renderFaq() {
            const container = document.getElementById('faqList');
            const items = siteData.faq || [];
            container.innerHTML = items.length ? items.map((f, i) => `
                <div class="item card">
                    <div class="item-header">
                        <span class="item-number">Question ${i + 1}</span>
                        <button class="delete-btn" onclick="deleteFaq(${i})">Remove</button>
                    </div>
                    <div class="form-group">
                        <label>Question</label>
                        <input type="text" value="${f.question || ''}" onchange="siteData.faq[${i}].question = this.value">
                    </div>
                    <div class="form-group">
                        <label>Answer</label>
                        <textarea rows="3" onchange="siteData.faq[${i}].answer = this.value">${f.answer || ''}</textarea>
                    </div>
                </div>
            `).join('') : '<p style="color:var(--text-light);padding:1rem">No FAQ items yet.</p>';
        }

        function addFaq() {
            siteData.faq.push({ question: '', answer: '', order: siteData.faq.length + 1 });
            renderFaq();
        }

        function deleteFaq(index) {
            siteData.faq.splice(index, 1);
            renderFaq();
        }

        async function saveFaq() {
            await saveToGitHub('faq', siteData.faq);
        }

        // =====================
        // THEME - FULL COLOR CONTROL SYSTEM
        // =====================
        const colorPresets = [
            {
                name: 'Classic Gold',
                gold: '#C4A052', goldLight: '#D4B872', goldDark: '#A68A42',
                sage: '#8B9B7A', sageLight: '#A5B494', sageDark: '#6B7B5A',
                white: '#FFFFFF', cream: '#FAF8F5', ivory: '#F5F2ED',
                taupe: '#E8E4DC', warmGray: '#9B9590', charcoal: '#3D3D3D', black: '#1A1A1A'
            },
            {
                name: 'Ocean Blue',
                gold: '#4A90A4', goldLight: '#6BA8C0', goldDark: '#2B6F8F',
                sage: '#5FA8BC', sageLight: '#7CBFD0', sageDark: '#3E8A9D',
                white: '#FFFFFF', cream: '#F0F8FA', ivory: '#E8F2F5',
                taupe: '#D0E5EC', warmGray: '#8BA5B8', charcoal: '#2C3E50', black: '#1A2634'
            },
            {
                name: 'Sage Garden',
                gold: '#8B9B7A', goldLight: '#A5B494', goldDark: '#6B7B5A',
                sage: '#6B8E5B', sageLight: '#8BA870', sageDark: '#4B6E3B',
                white: '#FFFFFF', cream: '#F5F8F2', ivory: '#EEF2E9',
                taupe: '#DFE5D3', warmGray: '#8FA885', charcoal: '#3D4A3C', black: '#1D2D1B'
            },
            {
                name: 'Dusty Rose',
                gold: '#D4A5A5', goldLight: '#E5BFBF', goldDark: '#B88585',
                sage: '#B8A5A5', sageLight: '#D0BFBF', sageDark: '#9A7A7A',
                white: '#FFFFFF', cream: '#FAF5F5', ivory: '#F5EFEF',
                taupe: '#E8DDD0', warmGray: '#A89090', charcoal: '#4A3D3D', black: '#2D1F1F'
            },
            {
                name: 'Midnight',
                gold: '#6B7A9A', goldLight: '#8A99B8', goldDark: '#4B5A7A',
                sage: '#5B6B8A', sageLight: '#7A8BA8', sageDark: '#3B4B6A',
                white: '#FFFFFF', cream: '#F0F2F5', ivory: '#E8EAED',
                taupe: '#D5D9E0', warmGray: '#7F8CA5', charcoal: '#2A2F42', black: '#1A1D2E'
            }
        ];

        function hexToRgb(hex) {
            const result = /^#?([a-f\d]{2})([a-f\d]{2})([a-f\d]{2})$/i.exec(hex);
            return result ? `${parseInt(result[1], 16)}, ${parseInt(result[2], 16)}, ${parseInt(result[3], 16)}` : '';
        }

        function renderTheme() {
            const container = document.getElementById('colorPresets');
            container.innerHTML = colorPresets.map((p, i) => `
                <div class="color-swatch" style="background:${p.gold}" title="${p.name}" onclick="applyPreset(${i})"></div>
            `).join('');

            // Load current values from siteData.theme
            loadThemeInputs();
            syncColorInputs();
        }

        function loadThemeInputs() {
            if (!siteData.theme) return;
            const theme = siteData.theme;

            // Load all 13 colors into inputs
            const colorIds = [
                'gold', 'goldLight', 'goldDark',
                'sage', 'sageLight', 'sageDark',
                'white', 'cream', 'ivory', 'taupe', 'warmGray', 'charcoal', 'black'
            ];

            colorIds.forEach(id => {
                const colorInput = document.getElementById('color' + id.charAt(0).toUpperCase() + id.slice(1));
                const hexInput = document.getElementById('color' + id.charAt(0).toUpperCase() + id.slice(1) + 'Hex');
                const rgbDisplay = document.getElementById('color' + id.charAt(0).toUpperCase() + id.slice(1) + 'Rgb');

                if (theme[id] && colorInput) {
                    colorInput.value = theme[id];
                    hexInput.value = theme[id];
                    rgbDisplay.textContent = 'RGB: ' + hexToRgb(theme[id]);
                }
            });
        }

        function applyPreset(index) {
            const preset = colorPresets[index];
            const colorIds = ['gold', 'goldLight', 'goldDark', 'sage', 'sageLight', 'sageDark', 'white', 'cream', 'ivory', 'taupe', 'warmGray', 'charcoal', 'black'];

            colorIds.forEach(id => {
                const inputId = 'color' + id.charAt(0).toUpperCase() + id.slice(1);
                const colorInput = document.getElementById(inputId);
                const hexInput = document.getElementById(inputId + 'Hex');
                const rgbDisplay = document.getElementById(inputId + 'Rgb');

                if (colorInput) {
                    colorInput.value = preset[id];
                    hexInput.value = preset[id];
                    rgbDisplay.textContent = 'RGB: ' + hexToRgb(preset[id]);
                }
            });

            updatePreview();
            document.querySelectorAll('.color-swatch').forEach((s, i) => {
                s.classList.toggle('active', i === index);
            });
        }

        function updatePreview() {
            const gold = document.getElementById('colorGold').value;
            const charcoal = document.getElementById('colorCharcoal').value;
            const cream = document.getElementById('colorCream').value;

            const previewBtn = document.getElementById('previewBtn');
            if (previewBtn) previewBtn.style.background = gold;
        }

        function syncColorInputs() {
            const colorIds = ['gold', 'goldLight', 'goldDark', 'sage', 'sageLight', 'sageDark', 'white', 'cream', 'ivory', 'taupe', 'warmGray', 'charcoal', 'black'];

            colorIds.forEach(id => {
                const inputId = 'color' + id.charAt(0).toUpperCase() + id.slice(1);
                const colorInput = document.getElementById(inputId);
                const hexInput = document.getElementById(inputId + 'Hex');
                const rgbDisplay = document.getElementById(inputId + 'Rgb');

                if (colorInput) {
                    colorInput.addEventListener('change', function() {
                        hexInput.value = this.value;
                        rgbDisplay.textContent = 'RGB: ' + hexToRgb(this.value);
                        updatePreview();
                    });
                }
                if (hexInput) {
                    hexInput.addEventListener('change', function() {
                        if (/^#[0-9A-Fa-f]{6}$/.test(this.value)) {
                            colorInput.value = this.value;
                            rgbDisplay.textContent = 'RGB: ' + hexToRgb(this.value);
                            updatePreview();
                        }
                    });
                }
            });
        }

        async function saveTheme() {
            const colorIds = ['gold', 'goldLight', 'goldDark', 'sage', 'sageLight', 'sageDark', 'white', 'cream', 'ivory', 'taupe', 'warmGray', 'charcoal', 'black'];
            const themeData = {};

            colorIds.forEach(id => {
                const inputId = 'color' + id.charAt(0).toUpperCase() + id.slice(1);
                themeData[id] = document.getElementById(inputId).value;
            });

            await saveToGitHub('theme', themeData);
            showToast('Theme saved! Refresh your website to see changes.', 'success');
        }

        function resetTheme() {
            if (confirm('Reset theme to Classic Gold?')) {
                applyPreset(0);
                saveTheme();
            }
        }

        // =====================
        // PHOTOS
        // =====================
        function renderPhotos() {
            const imageMap = siteData.imageMap || {};

            // Define photo categories
            const categories = {
                photosHero: {
                    title: 'Hero & Banners',
                    keys: ['hero-main', 'services-hero', 'gallery-hero', 'contact-hero', 'about-hero']
                },
                photosAbout: {
                    title: 'About Section',
                    keys: ['about-profile', 'about-hero', 'about-cta-image']
                },
                photosServices: {
                    title: 'Services Images',
                    keys: ['services-floral-main', 'services-floral-detail-1', 'services-floral-detail-2',
                           'services-decor-main', 'services-decor-detail-1', 'services-decor-detail-2',
                           'services-tailoring-main', 'services-tailoring-detail-1', 'services-tailoring-detail-2']
                },
                photosFeatured: {
                    title: 'Homepage Featured',
                    keys: ['services-cta-image', 'about-cta-image']
                },
                photosGallery: {
                    title: 'Gallery / Portfolio',
                    keys: ['gallery-hero', 'gallery-filter-hero']
                },
                photosTimeline: {
                    title: 'Process & Timeline',
                    keys: ['process-discovery', 'process-design', 'process-create', 'process-execute']
                }
            };

            // Render each category
            for (const [containerId, config] of Object.entries(categories)) {
                const container = document.getElementById(containerId);
                if (!container) continue;

                const html = config.keys
                    .filter(key => imageMap[key])
                    .map(key => createPhotoCard(key, imageMap[key]))
                    .join('');

                container.innerHTML = html;
            }
        }

        function createPhotoCard(imageId, imageUrl) {
            const label = imageId.replace(/-/g, ' ').replace(/([a-z])([A-Z])/g, '$1 $2').toUpperCase();
            return `
                <div class="photo-card" onclick="openPhotoModal('${imageId}')">
                    <img src="${imageUrl}" alt="${label}" onerror="this.src='data:image/svg+xml,%3Csvg xmlns=%22http://www.w3.org/2000/svg%22 viewBox=%220 0 200 120%22%3E%3Crect fill=%22%23f0f0f0%22 width=%22200%22 height=%22120%22/%3E%3Ctext x=%2250%25%22 y=%2250%25%22 text-anchor=%22middle%22 dy=%22.3em%22 font-family=%22Arial%22 font-size=%2212%22 fill=%22%23999%22%3ENo Image%3C/text%3E%3C/svg%3E'">
                    <div class="photo-card-info">
                        <div class="photo-card-label">${label}</div>
                        <div class="photo-card-desc">Click to edit</div>
                    </div>
                </div>
            `;
        }

        function openPhotoModal(imageId) {
            const imageMap = siteData.imageMap || {};
            const currentUrl = imageMap[imageId] || '';

            currentEditingPhoto = { id: imageId, url: currentUrl };
            const label = imageId.replace(/-/g, ' ').replace(/([a-z])([A-Z])/g, '$1 $2');
            document.getElementById('photoModalTitle').textContent = 'Edit: ' + label;
            document.getElementById('photoModalPreview').src = currentUrl;
            document.getElementById('photoModalUrl').value = currentUrl;
            document.getElementById('photoModal').classList.add('show');
        }

        function closePhotoModal() {
            document.getElementById('photoModal').classList.remove('show');
            currentEditingPhoto = null;
            document.getElementById('photoModalFile').value = '';
            document.getElementById('photoModalUrl').value = '';
        }

        // Handle file upload preview
        document.getElementById('photoModalFile').addEventListener('change', function(e) {
            const file = e.target.files[0];
            if (file) {
                const reader = new FileReader();
                reader.onload = function(event) {
                    document.getElementById('photoModalPreview').src = event.target.result;
                    document.getElementById('photoModalUrl').value = event.target.result;
                };
                reader.readAsDataURL(file);
            }
        });

        // Handle URL input preview
        document.getElementById('photoModalUrl').addEventListener('input', function() {
            if (this.value.startsWith('http') || this.value.startsWith('data:')) {
                document.getElementById('photoModalPreview').src = this.value;
            }
        });

        function savePhotoUrl() {
            if (!currentEditingPhoto) return;

            const newUrl = document.getElementById('photoModalUrl').value;
            if (!newUrl) {
                showToast('Please enter an image URL or upload a file', 'error');
                return;
            }

            // Update in imageMap
            siteData.imageMap[currentEditingPhoto.id] = newUrl;
            closePhotoModal();
            renderPhotos();
            showToast('Photo updated. Click "Save All Photos" to apply.', 'success');
        }

        async function saveImages() {
            await saveToGitHub('photos', { imageMap: siteData.imageMap });
        }

        // Close modal on outside click
        document.getElementById('photoModal').addEventListener('click', function(e) {
            if (e.target === this) closePhotoModal();
        });

        // =====================
        // FORM HANDLERS
        // =====================
        document.getElementById('heroForm').addEventListener('submit', async function(e) {
            e.preventDefault();
            const data = {
                badge: document.getElementById('heroBadge').value,
                titleLine1: document.getElementById('heroTitle1').value,
                titleLine2: document.getElementById('heroTitle2').value,
                subtitle: document.getElementById('heroSubtitle').value,
                description: document.getElementById('heroDesc').value,
                primaryBtn: document.getElementById('heroBtnPrimary').value,
                secondaryBtn: document.getElementById('heroBtnSecondary').value,
                heroImage: document.getElementById('heroImage').value
            };
            await saveToGitHub('hero', data);
        });

        document.getElementById('aboutForm').addEventListener('submit', async function(e) {
            e.preventDefault();
            const data = {
                name: document.getElementById('aboutName').value,
                title: document.getElementById('aboutTitle').value,
                bio: document.getElementById('aboutBio').value,
                years: parseInt(document.getElementById('aboutYears').value) || 0,
                events: parseInt(document.getElementById('aboutEvents').value) || 0,
                photo: document.getElementById('aboutPhoto').value
            };
            await saveToGitHub('about', data);
        });

        document.getElementById('contactForm').addEventListener('submit', async function(e) {
            e.preventDefault();
            const data = {
                businessName: document.getElementById('contactBusiness').value,
                tagline: document.getElementById('contactTagline').value,
                phone: document.getElementById('contactPhone').value,
                email: document.getElementById('contactEmail').value,
                address: document.getElementById('contactAddress').value,
                instagram: document.getElementById('contactInstagram').value,
                pinterest: document.getElementById('contactPinterest').value
            };
            await saveToGitHub('settings', data);
        });

        // =====================
        // SAVE TO GITHUB
        // =====================
        async function saveToGitHub(type, data) {
            showToast('Saving...', '');
            console.log('Saving:', type, data);

            // Update siteData with the new data
            siteData[type] = data;

            // Use absolute URL to avoid redirect issues
            // jlc-studio.vercel.app has the env vars, www.jlcstudio.art doesn't yet
            const apiUrl = window.location.hostname.includes('localhost')
                ? '/api/save-content'
                : 'https://jlc-studio.vercel.app/api/save-content';

            try {
                // Always save the entire siteData to 'admin' type (master admin.json)
                const res = await fetch(apiUrl, {
                    method: 'POST',
                    headers: {
                        'Content-Type': 'application/json',
                        'Authorization': `Bearer ${authToken}`
                    },
                    body: JSON.stringify({ type: 'admin', data: siteData }),
                    redirect: 'follow'
                });

                console.log('Response status:', res.status);

                // Handle non-JSON responses
                const text = await res.text();
                console.log('Response text:', text);

                let result;
                try {
                    result = JSON.parse(text);
                } catch (parseErr) {
                    console.error('Failed to parse JSON:', parseErr);
                    showToast('Server returned invalid response. Check console.', 'error');
                    return;
                }

                if (result.success) {
                    showToast('Saved! Site will update in ~30 seconds.', 'success');
                } else {
                    console.error('Save error:', result);
                    showToast('Error: ' + (result.error || result.details || 'Unknown error'), 'error');
                }
            } catch (e) {
                console.error('Network error:', e);
                showToast('Network error: ' + e.message, 'error');
            }
        }

        // =====================
        // TOAST
        // =====================
        function showToast(msg, type) {
            const toast = document.getElementById('toast');
            toast.textContent = msg;
            toast.className = 'toast ' + type + ' show';
            setTimeout(() => toast.classList.remove('show'), 4000);
        }

        // =====================
        // INIT
        // =====================
        checkAuth();
    </script>
</body>
</html>
